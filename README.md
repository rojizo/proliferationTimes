## Some programs and data related with the paper "Absorption and fixation times for evolutionary processes on graphs"

Code is in the `src` directory and data in `data`. The code is a mixture of Python, [SageMath](https://www.sagemath.org) and a C++ Python package called [proliferation](https://bitbucket.org/geodynapp/proliferation) developed for [doi 10.1016/j.jtbi.2021.110942](https://dx.doi.org/10.1016/j.jtbi.2021.110942)


#### Fixation and absorption times at critical probability

The code is in `src/order6` and data in `data/order6`

* `computer.py` accepts a number `i` (the n√∫mber of graph in the list of all connected graphs of order 6 as generated by Sage), and compute absoption and fixation probabilities and times for all update rules. It produces a file `{i}.sage` with the computed formulas and the data used to arrive to the result. Those files are saved in `data/order6`. 

* To evaluate on the critical propability we use the package [proliferation](https://bitbucket.org/geodynapp/proliferation). With the help of that package program `ventilador`  computes the critical probability for some values of fitness. This is stored in python's pickle format. The program consists in one `ventilador/server.py` which gives tasks to a pool of workers (`ventilador/client.py`). The `server.py` needs a cryptygraphic certificate. You must generate your own. 

* `evaluate.py` takes the outuput of `computer.py` and evaluates on the critial probabilities computed in the previous step. The final output is the file `evaluation.txt` located at `data/order6`


#### Fitness for which maximal time (for Moran) is achieved

The Jupyter Notebook `notebooks/timesWithMaximal.ipynb` contains the code. It uses the functions computed above and L-BFGS-B methods to compute the optimal point.

The results can be seen [here](https://rojizo.github.io/stuff/maximalTimes/).


#### Higher order but symmetric graphs

The notebook `notebooks/highorder.ipynb` contains the code to compute $\tau$ and $T$ and the ratios for $K_n$, $K_{1,n}$, $C_n$.
