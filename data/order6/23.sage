G = [(0, 3), (0, 5), (1, 4), (1, 5), (2, 4)]
moran_P = {(0, 1, 0, 0, 0, 0): {(0, 1, 0, 0, 0, 0): 4, (0, 1, 0, 0, 1, 0): 1/2*r, (0, 1, 0, 0, 0, 1): 1/2*r, (0, 0, 0, 0, 0, 0): 1}, (0, 0, 0, 0, 0, 0): {(0, 0, 0, 0, 0, 0): 6}, (0, 1, 0, 0, 0, 1): {(0, 1, 0, 0, 0, 1): r + 3, (0, 1, 0, 0, 0, 0): 1, (1, 1, 0, 0, 0, 1): r}, (1, 1, 0, 0, 0, 1): {(1, 1, 0, 1, 0, 1): 1/2*r, (1, 1, 0, 0, 0, 1): 2*r + 3/2, (1, 1, 0, 0, 1, 1): 1/2*r, (0, 1, 0, 0, 0, 1): 1, (0, 1, 0, 0, 1, 0): 1/2}, (0, 1, 0, 0, 1, 0): {(0, 1, 0, 0, 1, 0): r + 5/2, (1, 1, 0, 0, 0, 1): 1/2*r, (0, 1, 0, 0, 0, 0): 1, (0, 1, 1, 0, 1, 0): 1/2*r, (1, 0, 0, 0, 0, 0): 1/2}, (1, 0, 0, 0, 0, 0): {(1, 0, 0, 1, 0, 0): 1/2*r, (0, 1, 0, 0, 1, 0): 1/2*r, (1, 0, 0, 0, 0, 0): 7/2, (0, 0, 0, 0, 0, 0): 3/2}, (1, 0, 0, 1, 0, 0): {(1, 0, 0, 1, 0, 0): 3/2*r + 7/2, (0, 1, 1, 0, 1, 0): 1/2*r, (0, 0, 1, 0, 0, 0): 1/2}, (0, 0, 1, 0, 0, 0): {(0, 0, 1, 0, 0, 0): 9/2, (1, 0, 0, 1, 0, 0): r, (0, 0, 0, 0, 0, 0): 1/2}, (0, 1, 1, 0, 1, 0): {(0, 1, 1, 0, 1, 0): 5/2*r + 5/2, (1, 1, 0, 1, 0, 1): 1/2*r, (1, 0, 0, 1, 0, 0): 1/2}, (1, 1, 0, 1, 0, 1): {(1, 1, 0, 1, 0, 1): 7/2*r + 3/2, (1, 1, 1, 0, 1, 1): 1/2*r, (0, 1, 1, 0, 1, 0): 1/2}, (1, 1, 1, 0, 1, 1): {(1, 1, 1, 1, 1, 1): 1/2*r, (1, 1, 1, 0, 1, 1): 9/2*r, (1, 1, 0, 1, 0, 1): 1}, (1, 1, 1, 1, 1, 1): {(1, 1, 1, 1, 1, 1): 6*r}, (1, 1, 0, 0, 1, 1): {(1, 1, 1, 0, 1, 1): r, (1, 1, 0, 0, 1, 1): 3*r, (1, 1, 0, 0, 0, 1): 2}}
moran_W = {(0, 1, 0, 0, 0, 0): r + 5, (0, 0, 0, 0, 0, 0): 6, (0, 1, 0, 0, 0, 1): 2*r + 4, (1, 1, 0, 0, 0, 1): 3*r + 3, (0, 1, 0, 0, 1, 0): 2*r + 4, (1, 0, 0, 0, 0, 0): r + 5, (1, 0, 0, 1, 0, 0): 2*r + 4, (0, 0, 1, 0, 0, 0): r + 5, (0, 1, 1, 0, 1, 0): 3*r + 3, (1, 1, 0, 1, 0, 1): 4*r + 2, (1, 1, 1, 0, 1, 1): 5*r + 1, (1, 1, 1, 1, 1, 1): 6*r, (1, 1, 0, 0, 1, 1): 4*r + 2}
moran_Q = [(r + 1/2, 0, 0, 0, 0, 0, -r, 0, 0, 0, 0), (0, r + 1, -1/2*r, -1/2*r, 0, 0, 0, 0, 0, 0, 0), (0, -1, r + 1, 0, 0, 0, 0, -r, 0, 0, 0), (0, -1, 0, r + 3/2, -1/2*r, -1/2, 0, -1/2*r, 0, 0, 0), (0, 0, 0, 0, 1/2*r + 1/2, 0, -1/2, 0, 0, -1/2*r, 0), (0, 0, 0, -1/2*r, 0, r + 3/2, -1/2*r, 0, 0, 0, 0), (-1/2, 0, 0, 0, -1/2*r, 0, 1/2*r + 1/2, 0, 0, 0, 0), (0, 0, -1, -1/2, 0, 0, 0, r + 3/2, -1/2*r, -1/2*r, 0), (0, 0, 0, 0, 0, 0, 0, -2, r + 2, 0, -r), (0, 0, 0, 0, -1/2, 0, 0, 0, 0, 1/2*r + 1/2, -1/2*r), (0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 1/2*r + 1)]
moran_b = (0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1/2*r)
moran_used_states = {(0, 0, 0, 0, 0, 0): 0, (0, 0, 1, 0, 0, 0): 1, (0, 1, 0, 0, 0, 0): 2, (0, 1, 0, 0, 0, 1): 3, (0, 1, 0, 0, 1, 0): 4, (0, 1, 1, 0, 1, 0): 5, (1, 0, 0, 0, 0, 0): 6, (1, 0, 0, 1, 0, 0): 7, (1, 1, 0, 0, 0, 1): 8, (1, 1, 0, 0, 1, 1): 9, (1, 1, 0, 1, 0, 1): 10, (1, 1, 1, 0, 1, 1): 11, (1, 1, 1, 1, 1, 1): 12}
moran_w = (r + 5, r + 5, 2*r + 4, 2*r + 4, 3*r + 3, r + 5, 2*r + 4, 3*r + 3, 4*r + 2, 4*r + 2, 5*r + 1)
moran_det = 1/16*r^11 + 11/32*r^10 + 29/32*r^9 + 207/128*r^8 + 297/128*r^7 + 1415/512*r^6 + 1415/512*r^5 + 1331/512*r^4 + 1237/512*r^3 + 503/256*r^2 + 159/128*r + 27/64
moran_Phi_used_values = [{r: 1}, {r: 2}, {r: 3}, {r: 4}, {r: 5}, {r: 6}, {r: 7}, {r: 1/2}, {r: 1/3}, {r: 1/4}, {r: 1/5}, {r: 1/6}]
moran_Phi_computed = [(1/4, 1/8, 1/4, 1/4, 1/2, 1/8, 3/8, 3/8, 1/2, 5/8, 3/4), (2/3, 3755/7968, 11401/15936, 11129/15936, 11/12, 3487/7968, 5/6, 26693/31872, 57901/63744, 23/24, 47/48), (243/304, 828873/1287136, 279369/321784, 273213/321784, 297/304, 764397/1287136, 567/608, 1213677/1287136, 313803/321784, 603/608, 303/304), (1024/1195, 9581824/13045337, 60414784/65226685, 59358016/65226685, 1184/1195, 44450048/65226685, 1152/1195, 12708240/13045337, 270412/272915, 1192/1195, 1194/1195), (3125/3516, 332215625/421026936, 200704375/210513468, 197954375/210513468, 875/879, 310590625/421026936, 6875/7032, 415247375/421026936, 104822525/105256734, 7025/7032, 3515/3516), (3888/4277, 20581614/24939187, 24143103/24939187, 23880663/24939187, 4266/4277, 19376334/24939187, 324/329, 49473369/49878374, 99545499/99756748, 4275/4277, 8553/8554), (16807/18208, 117145546315/137659726784, 2101105496/2150933231, 8330656061/8603732924, 18179/18208, 110943561631/137659726784, 36015/36416, 136945781091/137659726784, 34373797969/34414931696, 36407/36416, 18207/18208), (1/48, 1043/141216, 1543/70608, 793/35304, 1/12, 283/35304, 1/24, 1793/35304, 947/8826, 1/6, 1/3), (1/304, 110705/108145568, 109247/27036392, 112163/27036392, 7/304, 121637/108145568, 5/608, 1415837/108145568, 1078403/27036392, 41/608, 61/304), (1/1195, 2977/12169163, 73639/60845815, 75211/60845815, 11/1195, 16283/60845815, 3/1195, 61731/12169163, 1241783/60845815, 43/1195, 171/1195), (1/3516, 1551527/19337233512, 4615981/9668616756, 4693181/9668616756, 4/879, 1684447/19337233512, 7/7032, 47634137/19337233512, 59699003/4834308378, 157/7032, 391/3516), (1/8554, 260903/8092990724, 69781/311268874, 459584/2023247681, 11/4277, 10813/311268874, 2/4277, 2783681/2023247681, 16724753/2023247681, 5/329, 389/4277)]
moran_PhiNum = {(0, 0, 1, 0, 0, 0): 1/16*r^11 + 5/16*r^10 + 23/32*r^9 + 137/128*r^8 + 317/256*r^7 + 33/32*r^6 + 27/64*r^5, (0, 1, 0, 0, 0, 0): 1/16*r^11 + 9/32*r^10 + 69/128*r^9 + 79/128*r^8 + 131/256*r^7 + 159/512*r^6 + 27/256*r^5, (1, 0, 0, 0, 0, 0): 1/16*r^11 + 1/4*r^10 + 59/128*r^9 + 149/256*r^8 + 75/128*r^7 + 195/512*r^6 + 27/256*r^5}
moran_mean_phi = (1/16*r^11 + 9/32*r^10 + 55/96*r^9 + 581/768*r^8 + 299/384*r^7 + 147/256*r^6 + 27/128*r^5)/(1/16*r^11 + 11/32*r^10 + 29/32*r^9 + 207/128*r^8 + 297/128*r^7 + 1415/512*r^6 + 1415/512*r^5 + 1331/512*r^4 + 1237/512*r^3 + 503/256*r^2 + 159/128*r + 27/64)
moran_UT_used_values = [{r: 1}, {r: 2}, {r: 3}, {r: 4}, {r: 5}, {r: 6}, {r: 7}, {r: 1/2}, {r: 1/3}, {r: 1/4}, {r: 1/5}, {r: 1/6}]
moran_UT_computed = [(48, 28608/1243, 48930/1243, 50586/1243, 72, 29508/1243, 66, 61794/1243, 63570/1243, 66, 48), (48, 80867/2656, 221025/5312, 226993/5312, 211/4, 80615/2656, 113/2, 458845/10624, 792837/21248, 335/8, 423/16), (802/19, 3562199/120669, 13006462/362007, 1506714/40223, 786/19, 10784345/362007, 885/19, 37719181/1086021, 30543466/1086021, 601/19, 362/19), (9294/239, 370451619/13045337, 421751571/13045337, 445673460/13045337, 8640/239, 380266062/13045337, 9918/239, 395440548/13045337, 1301295/54583, 6528/239, 3849/239), (10800/293, 483349940/17542789, 527181606/17542789, 562687094/17542789, 9752/293, 503486120/17542789, 11294/293, 486828130/17542789, 376926414/17542789, 7334/293, 4272/293), (21698/611, 383758509/14250964, 1218908525/42752892, 655320217/21376446, 19242/611, 303379423/10688223, 1722/47, 1674259469/64129338, 2567860915/128258676, 14441/611, 16691/1222), (19662/569, 56905465857/2150933231, 58952507850/2150933231, 63742500174/2150933231, 17226/569, 60556220325/2150933231, 20091/569, 53713971255/2150933231, 40928044254/2150933231, 12915/569, 7422/569), (423/16, 488557/47072, 465561/23536, 241159/11768, 211/4, 124105/11768, 335/8, 336383/11768, 100227/2942, 113/2, 48), (362/19, 25538523/3379549, 48154050/3379549, 48008566/3379549, 786/19, 23914055/3379549, 601/19, 68686945/3379549, 84081386/3379549, 885/19, 802/19), (3849/239, 321653139/48676652, 149460759/12169163, 287134485/24338326, 8640/239, 282016647/48676652, 6528/239, 206605722/12169163, 252455370/12169163, 9918/239, 9294/239), (4272/293, 4963683316/805718063, 9139698498/805718063, 8527162018/805718063, 9752/293, 4152482464/805718063, 7334/293, 12293977022/805718063, 14901695082/805718063, 11294/293, 10800/293), (16691/1222, 1706759748/289035383, 240314295/22233491, 2850356891/289035383, 19242/611, 212322377/44466982, 14441/611, 4113122399/289035383, 4942026070/289035383, 1722/47, 21698/611)]
moran_unconditional_times_num = {(0, 0, 1, 0, 0, 0): 29/16*r^11 + 197/16*r^10 + 1275/32*r^9 + 10789/128*r^8 + 34625/256*r^7 + 11113/64*r^6 + 11289/64*r^5 + 4519/32*r^4 + 23759/256*r^3 + 6457/128*r^2 + 1281/64*r + 135/32, (0, 1, 0, 0, 0, 0): 93/64*r^11 + 1217/128*r^10 + 115/4*r^9 + 1767/32*r^8 + 9969/128*r^7 + 22023/256*r^6 + 603/8*r^5 + 3403/64*r^4 + 4111/128*r^3 + 4471/256*r^2 + 507/64*r + 135/64, (1, 0, 0, 0, 0, 0): 107/64*r^11 + 627/64*r^10 + 7099/256*r^9 + 3357/64*r^8 + 19573/256*r^7 + 2835/32*r^6 + 20693/256*r^5 + 7605/128*r^4 + 9427/256*r^3 + 2415/128*r^2 + 449/64*r + 45/32}
moran_unconditional_mean_time_from1 = (79/48*r^10 + 3415/384*r^9 + 5943/256*r^8 + 31313/768*r^7 + 42823/768*r^6 + 3861/64*r^5 + 38813/768*r^4 + 26161/768*r^3 + 15247/768*r^2 + 871/96*r + 165/64)/(1/16*r^10 + 9/32*r^9 + 5/8*r^8 + 127/128*r^7 + 85/64*r^6 + 735/512*r^5 + 85/64*r^4 + 651/512*r^3 + 293/256*r^2 + 105/128*r + 27/64)
moran_CT_used_values = [{r: 1}, {r: 2}, {r: 3}, {r: 4}, {r: 5}, {r: 6}, {r: 7}, {r: 8}, {r: 9}, {r: 10}, {r: 11}, {r: 12}, {r: 1/2}, {r: 1/3}, {r: 1/4}, {r: 1/5}, {r: 1/6}, {r: 1/7}, {r: 1/8}, {r: 1/9}, {r: 1/10}, {r: 1/11}, {r: 1/12}]
moran_CT_computed = [(87, 91293/1243, 84717/1243, 90411/1243, 72, 101049/1243, 83, 77553/1243, 63015/1243, 279/5, 35), (1031/16, 68676257/1246660, 193897435/3785132, 200706867/3694828, 9389/176, 69810245/1157684, 4931/80, 414058735/8862076, 727659959/19223132, 15137/368, 19273/752), (1933/38, 3661031455/85159026, 3413898455/86107734, 396392039/9356702, 17387/418, 11166956305/235604142, 12923/266, 40194971555/1122246666, 8203466861/290163174, 80263/2546, 72721/3838), (10641/239, 18205279782720/488273918573, 421103976057186/12314550266597, 445215360407244/12099145662053, 320583/8843, 93727559638668/2265100999321, 10163/239, 531213227144122/17269090987175, 21070318988694/881903917211, 971757/35611, 764819/47561), (12007/293, 63571627683131/1864956355801, 175491580149845/5633463203203, 187288622390931/5556274931603, 136747/4102, 66300626044175/1743560255921, 126217/3223, 56217374265269/2009544022739, 1582018461330173/73555177540889, 2060155/82333, 3001669/205979), (47339/1222, 4837478033504/150878518609, 31040288721122/1061921270683, 33365076338536/1050377989843, 3043241/96538, 15302048984356/426128762787, 45271/1222, 15569673865082/593470707557, 789370603741250/39406092294751, 13716953/580450, 47575825/3483922), (42333/1138, 919591163679098583/29984202824130790, 840644325710742705/30116369067442816, 908585393175062091/29852036580818764, 1827141/60314, 978466909925411595/28396762477255246, 202561/5690, 14342447184674025845/572519400182474898, 57440267343191583699/3017785482742955422, 19190331/845534, 756967/58038), (140741/3901, 1612011646158214160/54360281500881241, 13235801119915388650/491012758890092321, 14367041191909553964/487472308125770017, 15716003/534437, 1728162522370589540/51741260074315529, 2291171/66317, 1161516406411698050/48002802144623867, 585450500726433923522/31962909215118973793, 94255061/4279397, 431568529/34239077), (110503/3137, 2009841514543159/69587072834833, 228847877420720723/8724631934612861, 249257025722877477/8672136274095389, 3876406/134891, 54205649324624723/1662895784693401, 2011721/59603, 3740859402519237801/158835547304419795, 6365927591427273029/358102706872415161, 104576911/4859213, 268459153/21868027), (331599/9596, 685998326717922516/24260800068994021, 6865559290130011920/267549814697485631, 7498579895594462802/266187786820382831, 57127941/2024756, 743988681613353930/23273859143538961, 2225233/67172, 20746657790503750272/900146653660800577, 469406357073933967572/27045184701469364731, 428016465/20257156, 811766867/67527052), (239677/7046, 732310844248077104939/26354315115948530074, 153612418045834860061/6095050878703526714, 2186069109965021208249/78890229272545333162, 24872639/894842, 61370196664605843299/1950817091674790378, 5287099/162058, 79558220785864936406407/3513414282035566838722, 164633635528492523731355/9673071837425619297194, 31532923/1514890, 1280064745/108318158), (671801/20011, 762382012523386432/27839678145806835, 9002042912445129110/362599902980402967, 3291113452068495244/120410576270191581, 165351839/6023311, 2501438183370792220/80585722821910977, 16114651/500275, 97725176428054758170/4379722600995556551, 293608134424589629178/17534767765774850349, 1486379837/72299743, 10108741513/867616927), (1031/16, 1178756395/24548048, 1512686015/36316048, 876777321/18664048, 739/16, 382976815/6660688, 943/16, 136188235/3836368, 544735673/22288592, 493/16, 121/8), (1933/38, 25780460830923/748265944090, 20720187395955/738411179206, 24854606713171/758120708974, 8439/266, 35730697862375/822156403426, 8449/190, 212830589806975/9569781035026, 96464238901913/7289031560494, 717/38, 17897/2318), (10641/239, 4131397214865/144910393004, 19912104060321/896124994157, 48245130985563/1830509836786, 66144/2629, 29198458793673/792601924516, 8968/239, 20924428110818/1252024335255, 136424153443686/15111459737629, 144234/10277, 69982/13623), (12007/293, 31696226934116987/1250093329132201, 71237642461944013/3719179270164803, 86437292585320683/3781380704628403, 50641/2344, 44929734855655823/1357189374066161, 68813/2051, 532726686985491889/38379684596316631, 337286329315125121/48100565060191189, 533783/46001, 26525/6739), (47339/1222, 3534656415643833/150820397061698, 53676903621543/3102950470942, 5497882944276713/265672074921344, 130527/6721, 96020259409267/3125339596379, 75737/2444, 676921437379909/55488434757574, 28356287505424040/4834045388935399, 31092/3055, 775330/237679), (42333/1138, 4439480242759151655/200366841331861894, 3201490959280911885/199303443651978796, 3874167954250634379/201430239011744992, 592653/33002, 57205843807333575/1967585928939814, 33229/1138, 41995411072729796005/3784284168134536562, 102121819215158880501/19882834889817040114, 4220829/456338, 1506887/531446), (140741/3901, 512888368186009637/24139667482697860, 821135042431570145/54077712203275489, 1983998862020334183/109101582937729762, 2441608/144337, 715830696479700335/25688975853597044, 543764/19505, 4525796430600745405/438420074864083681, 16260444555323993182/3509017696903216801, 9830162/1142993, 23218874/9132241), (110503/3137, 321613315732566915/15636678741382853, 5658489708037598643/389497991414710541, 6825739968072690917/392335945654432109, 1164426/72151, 2230367265290642627/82786567849556329, 926929/34507, 69095347605268460569/7086309284931982435, 68075131279581695069/15949072020181598881, 20918439/2575477, 26972033/11578667), (331599/9596, 260243383699978431/12984345997208908, 998056781896167999/71194827445013644, 601209396472970217/35816489262142172, 2087451/134344, 89707239969630351/3422405421904792, 250033/9596, 1114537488277897131/119703561984850924, 3583536884341417977/897962644336073818, 5172381/666922, 2407780/1110737), (239677/7046, 4147499569079841393299/211336761029233634314, 8607943288562084078273/632346407104705588282, 10359624817098422520729/635674159070696217602, 7109939/472082, 5687492200328570890847/221982827210851146674, 178973/7046, 251207043683835952186927/28027923169704298260082, 290862430657522309733185/77088004623406184006014, 77065589/10322390, 115802065/56741438), (671801/20011, 22406159807514813975/1161848056774905236, 50036742339552022095/3767437347725374103, 120333861355319318089/7569150042623019862, 23195856/1580869, 30572147874170136055/1216387264442240924, 3481936/140077, 394887303605363140160/45491141350105147631, 1964352257450629649794/545951251358696876231, 136455114/18870373, 438825322/226344421)]
moran_conditional_times = {(0, 0, 1, 0, 0, 0): (29/256*r^4 + 37/256*r^3 + 21/128*r^2 + 37/256*r + 29/256)/(1/256*r^4 - 1/512*r^3 + 1/256*r^2 - 1/512*r + 1/256), (0, 1, 0, 0, 0, 0): (93/1024*r^16 + 1023/1024*r^15 + 21737/4096*r^14 + 150297/8192*r^13 + 768743/16384*r^12 + 3120727/32768*r^11 + 10466907/65536*r^10 + 3706857/16384*r^9 + 17942165/65536*r^8 + 37176781/131072*r^7 + 8181357/32768*r^6 + 24057563/131072*r^5 + 7220533/65536*r^4 + 1727613/32768*r^3 + 317799/16384*r^2 + 10287/2048*r + 729/1024)/(1/256*r^16 + 9/256*r^15 + 311/2048*r^14 + 1753/4096*r^13 + 3705/4096*r^12 + 25349/16384*r^11 + 36517/16384*r^10 + 182061/65536*r^9 + 101081/32768*r^8 + 410251/131072*r^7 + 766589/262144*r^6 + 162643/65536*r^5 + 486097/262144*r^4 + 4791/4096*r^3 + 19377/32768*r^2 + 891/4096*r + 729/16384), (1, 0, 0, 0, 0, 0): (107/1024*r^16 + 2205/2048*r^15 + 22297/4096*r^14 + 37407/2048*r^13 + 379093/8192*r^12 + 1549579/16384*r^11 + 2641721/16384*r^10 + 30591329/131072*r^9 + 37986323/131072*r^8 + 20296263/65536*r^7 + 37145253/131072*r^6 + 28782761/131072*r^5 + 9292115/65536*r^4 + 75869/1024*r^3 + 240327/8192*r^2 + 62127/8192*r + 3645/4096)/(1/256*r^16 + 17/512*r^15 + 283/2048*r^14 + 787/2048*r^13 + 6713/8192*r^12 + 23453/16384*r^11 + 69189/32768*r^10 + 176637/65536*r^9 + 400965/131072*r^8 + 103157/32768*r^7 + 777011/262144*r^6 + 334493/131072*r^5 + 515601/262144*r^4 + 21237/16384*r^3 + 22293/32768*r^2 + 2025/8192*r + 729/16384)}
moran_conditional_mean_time_from1 = (79/18889465931478580854784*r^22 + 4693/75557863725914323419136*r^21 + 68089/151115727451828646838272*r^20 + 1294809/604462909807314587353088*r^19 + 9132283/1208925819614629174706176*r^18 + 25595073/1208925819614629174706176*r^17 + 237969583/4835703278458516698824704*r^16 + 942804319/9671406556917033397649408*r^15 + 405063281/2417851639229258349412352*r^14 + 4888462967/19342813113834066795298816*r^13 + 26088973757/77371252455336267181195264*r^12 + 30913008707/77371252455336267181195264*r^11 + 130284894937/309485009821345068724781056*r^10 + 121914968639/309485009821345068724781056*r^9 + 12617401101/38685626227668133590597632*r^8 + 36723690393/154742504910672534362390528*r^7 + 23240748085/154742504910672534362390528*r^6 + 25201096213/309485009821345068724781056*r^5 + 11448904929/309485009821345068724781056*r^4 + 1051501797/77371252455336267181195264*r^3 + 73333269/19342813113834066795298816*r^2 + 6869367/9671406556917033397649408*r + 1279395/19342813113834066795298816)/(3/18889465931478580854784*r^22 + 39/18889465931478580854784*r^21 + 987/75557863725914323419136*r^20 + 4089/75557863725914323419136*r^19 + 201543/1208925819614629174706176*r^18 + 247953/604462909807314587353088*r^17 + 4073433/4835703278458516698824704*r^16 + 14361939/9671406556917033397649408*r^15 + 44344431/19342813113834066795298816*r^14 + 121821303/38685626227668133590597632*r^13 + 301720389/77371252455336267181195264*r^12 + 340449393/77371252455336267181195264*r^11 + 705304191/154742504910672534362390528*r^10 + 1345759551/309485009821345068724781056*r^9 + 1179658971/309485009821345068724781056*r^8 + 1883551647/618970019642690137449562112*r^7 + 674574741/309485009821345068724781056*r^6 + 849157281/618970019642690137449562112*r^5 + 228437361/309485009821345068724781056*r^4 + 25263333/77371252455336267181195264*r^3 + 4310577/38685626227668133590597632*r^2 + 1003833/38685626227668133590597632*r + 59049/19342813113834066795298816)
bernoulli_P = {(0, 1, 0, 0, 0, 0): {(0, 1, 0, 0, 0, 0): -r*p + r + 4, (1, 1, 0, 0, 0, 1): r*p, (0, 0, 0, 0, 0, 0): 1}, (0, 0, 0, 0, 0, 0): {(0, 0, 0, 0, 0, 0): 6}, (1, 1, 0, 0, 0, 1): {(1, 1, 0, 1, 0, 1): r*p, (1, 1, 0, 0, 0, 1): -2*r*p + 3*r + 3/2, (1, 1, 0, 0, 1, 1): r*p, (0, 1, 0, 0, 0, 1): 1, (0, 1, 0, 0, 1, 0): 1/2}, (0, 1, 0, 0, 1, 0): {(0, 1, 0, 0, 1, 0): -2*r*p + 2*r + 5/2, (1, 1, 0, 0, 0, 1): r*p, (0, 1, 0, 0, 0, 0): 1, (0, 1, 1, 0, 1, 0): r*p, (1, 0, 0, 0, 0, 0): 1/2}, (1, 0, 0, 0, 0, 0): {(0, 1, 1, 0, 1, 0): r*p, (1, 0, 0, 0, 0, 0): -r*p + r + 7/2, (0, 0, 0, 0, 0, 0): 3/2}, (0, 1, 1, 0, 1, 0): {(0, 1, 1, 0, 1, 0): -r*p + 3*r + 5/2, (1, 1, 0, 1, 0, 1): r*p, (1, 0, 0, 1, 0, 0): 1/2}, (1, 0, 0, 1, 0, 0): {(0, 1, 1, 0, 1, 0): r*p, (1, 0, 0, 1, 0, 0): -r*p + 2*r + 7/2, (0, 0, 1, 0, 0, 0): 1/2}, (0, 0, 1, 0, 0, 0): {(0, 0, 1, 0, 0, 0): -r*p + r + 9/2, (1, 0, 0, 1, 0, 0): r*p, (0, 0, 0, 0, 0, 0): 1/2}, (1, 1, 0, 1, 0, 1): {(1, 1, 0, 1, 0, 1): -r*p + 4*r + 3/2, (1, 1, 1, 0, 1, 1): r*p, (0, 1, 1, 0, 1, 0): 1/2}, (1, 1, 1, 0, 1, 1): {(1, 1, 1, 1, 1, 1): r*p, (1, 1, 1, 0, 1, 1): -r*p + 5*r, (1, 1, 0, 1, 0, 1): 1}, (1, 1, 1, 1, 1, 1): {(1, 1, 1, 1, 1, 1): 6*r}, (0, 1, 0, 0, 0, 1): {(0, 1, 0, 0, 0, 1): -2*r*p + 2*r + 3, (0, 1, 0, 0, 0, 0): 1, (1, 1, 0, 0, 0, 1): 2*r*p}, (1, 1, 0, 0, 1, 1): {(1, 1, 1, 0, 1, 1): 2*r*p, (1, 1, 0, 0, 1, 1): -2*r*p + 4*r, (1, 1, 0, 0, 0, 1): 2}}
bernoulli_W = {(0, 1, 0, 0, 0, 0): r + 5, (0, 0, 0, 0, 0, 0): 6, (1, 1, 0, 0, 0, 1): 3*r + 3, (0, 1, 0, 0, 1, 0): 2*r + 4, (1, 0, 0, 0, 0, 0): r + 5, (0, 1, 1, 0, 1, 0): 3*r + 3, (1, 0, 0, 1, 0, 0): 2*r + 4, (0, 0, 1, 0, 0, 0): r + 5, (1, 1, 0, 1, 0, 1): 4*r + 2, (1, 1, 1, 0, 1, 1): 5*r + 1, (1, 1, 1, 1, 1, 1): 6*r, (0, 1, 0, 0, 0, 1): 2*r + 4, (1, 1, 0, 0, 1, 1): 4*r + 2}
bernoulli_Q = [(r*p + 1/2, 0, 0, 0, 0, 0, -r*p, 0, 0, 0, 0), (0, r*p + 1, 0, 0, 0, 0, 0, -r*p, 0, 0, 0), (0, -1, 2*r*p + 1, 0, 0, 0, 0, -2*r*p, 0, 0, 0), (0, -1, 0, 2*r*p + 3/2, -r*p, -1/2, 0, -r*p, 0, 0, 0), (0, 0, 0, 0, r*p + 1/2, 0, -1/2, 0, 0, -r*p, 0), (0, 0, 0, 0, -r*p, r*p + 3/2, 0, 0, 0, 0, 0), (-1/2, 0, 0, 0, -r*p, 0, r*p + 1/2, 0, 0, 0, 0), (0, 0, -1, -1/2, 0, 0, 0, 2*r*p + 3/2, -r*p, -r*p, 0), (0, 0, 0, 0, 0, 0, 0, -2, 2*r*p + 2, 0, -2*r*p), (0, 0, 0, 0, -1/2, 0, 0, 0, 0, r*p + 1/2, -r*p), (0, 0, 0, 0, 0, 0, 0, 0, 0, -1, r*p + 1)]
bernoulli_b = (0, 0, 0, 0, 0, 0, 0, 0, 0, 0, r*p)
bernoulli_used_states = {(0, 0, 0, 0, 0, 0): 0, (0, 0, 1, 0, 0, 0): 1, (0, 1, 0, 0, 0, 0): 2, (0, 1, 0, 0, 0, 1): 3, (0, 1, 0, 0, 1, 0): 4, (0, 1, 1, 0, 1, 0): 5, (1, 0, 0, 0, 0, 0): 6, (1, 0, 0, 1, 0, 0): 7, (1, 1, 0, 0, 0, 1): 8, (1, 1, 0, 0, 1, 1): 9, (1, 1, 0, 1, 0, 1): 10, (1, 1, 1, 0, 1, 1): 11, (1, 1, 1, 1, 1, 1): 12}
bernoulli_w = (r + 5, r + 5, 2*r + 4, 2*r + 4, 3*r + 3, r + 5, 2*r + 4, 3*r + 3, 4*r + 2, 4*r + 2, 5*r + 1)
bernoulli_det = 16*r^11*p^11 + 78*r^10*p^10 + 158*r^9*p^9 + 371/2*r^8*p^8 + 156*r^7*p^7 + 107*r^6*p^6 + 991/16*r^5*p^5 + 65/2*r^4*p^4 + 1015/64*r^3*p^3 + 421/64*r^2*p^2 + 141/64*r*p + 27/64
bernoulli_Phi_used_values = [{r: 151, p: 1/617}, {r: 109, p: 1/967}, {r: 31, p: 1/179}, {r: 433, p: 1/257}, {r: 547, p: 1/977}, {r: 241, p: 1/337}, {r: 359, p: 1/911}, {r: 373, p: 1/809}, {r: 571, p: 1/991}, {r: 233, p: 1/337}, {r: 727, p: 1/607}, {r: 607, p: 1/229}]
bernoulli_Phi_computed = [(628021806008/65538962130131, 75091717661083715584754235761/8085471372443049278807094028800, 81710247726968134477425719/3755444204571783222855129600, 606286494932373349946016244969/28299149803550672475824829100800, 4532486615754/65538962130131, 1368810957957708/141105385466172043, 1911099469276/65538962130131, 497296143450885533673869111/10527957516201887081780070350, 2842293374790641229202762367017/28299149803550672475824829100800, 9888102077267/65538962130131, 41659745477405/131077924260262), (123089916392/484256787289303, 956686412949407453086676171355/2475038403426690478338393506133272, 807330306286419791634325883/793535877982266905526897565288, 8832127876910673979763772438903/8662634411993416674184377271466452, 3091024428302/484256787289303, 673843325369836/1510396919555336057, 669089683140/484256787289303, 8776939568343187642997029095/2300221564522946541206685414622, 70565268728787793213301373087431/4331317205996708337092188635733226, 13834193687805/484256787289303, 122977054108999/968513574578606), (114516604/58053349195, 495731552225777429851969/217762810343927896851652800, 2056977395127707177809/363543923779512348667200, 611551520566838248199921/108881405171963948425826400, 1399670553/58053349195, 86779574286/34773956167805, 445137122/58053349195, 15991340394379917091999/1036965763542513794531680, 9569156636074248577905637/217762810343927896851652800, 1662200377/23221339678, 48447399881/232213396780), (15220870177393/21664378123885, 51066021249884492322055007381989/86146357547499634895454286353600, 45472859527947010081972401943/52624531183567278494474212800, 252676053255984758537037810159167/301512251416248722134090002237600, 84313711617879/86657512495540, 36507837130541607/70929173977599490, 39475836510883/43328756247770, 117935383948924924531304866933/124849793547100920138339545440, 589361503205475270270959726590129/603024502832497444268180004475200, 34361994540547/34663004998216, 345508895089103/346630049982160), (391765888380056/2027396508483077, 11958465287270526936770631576751117/77843859036119242640881207365653400, 40419728155911969366197209578589/135380624410642161114576012809832, 11217106047806845001381041108229087/38921929518059621320440603682826700, 1054084009053138/2027396508483077, 164738272272018996/1165752992377769275, 741633596741404/2027396508483077, 21861910945649957836875012023311/51078647661495566037323626880350, 5395661228844907525467262739807384/9730482379514905330110150920706675, 1333118792260235/2027396508483077, 3164623294197497/4054793016966154), (812990017201/2522631714332, 873580152020318028310107162807/3424039955127679325494382556928, 1066642432259240571807212653/2293395817232203165100055296, 765849402397847752340372116851/1712019977563839662747191278464, 7115317857367/10090526857328, 1714791603625447/7532578298995352, 2762816697459/5045263428664, 3624813908798000117469324327/5923944559044427898779208576, 2495486971044985424719498905589/3424039955127679325494382556928, 16453555481727/20181053714656, 36015509143855/40362107429312), (11926204131598/179960142987335, 491432818658596495730789959969803/8915143382897746025059818469343200, 2111743235488137182391362627249/18083455137723622768884013122400, 506516264576252916382894799603487/4457571691448873012529909234671600, 92515413396497/359920285974670, 4744719058477489/88720350492756155, 27058198510269/179960142987335, 1368893645288569625991058384317/7019797939289563799259699582160, 2668809773690282824995863567615869/8915143382897746025059818469343200, 56494468377261/143968114389868, 812212706753129/1439681143898680), (28880462932372/257572992855283, 380376266840375058093265361680285/4189280271337950113682024624101856, 244614962598311934465122419087/1320290031937582765106216395872, 2633243332205221311060605532072419/14662480949682825397887086184356496, 94164260642787/257572992855283, 70246538439519102/817279106329812959, 60199892573510/257572992855283, 1019775514317359405075778449545/3544230348001649842370579208208, 11916461676132319320822019020006307/29324961899365650795774172368712992, 261993866508215/515145985710566, 683760559518083/1030291971421132), (242795443727404/1171609991711063, 10978459834422701230194603789270423/66737128708123990707228501593734720, 5146957259457431425313925827131/16218014266858806976240219099328, 10216617646816797726093055518282663/33368564354061995353614250796867360, 636320903207437/1171609991711063, 726678471462893054/4821175115891024245, 453487461883146/1171609991711063, 211493972291855890599195519583143/469979779634675990895975363336160, 38474280396209435524849038449619763/66737128708123990707228501593734720, 1589958689693985/2343219983422126, 3730637224098301/4686439966844252), (1373439712786/4523388592615, 479901535114019911704097987349/1997431009710294670635482997600, 4183450492899301845490268881/9466497676352107443770061600, 424650886727623933428233049361/998715504855147335317741498800, 6169929160479/9046777185230, 205370499198801/954434993041765, 2366678303363/4523388592615, 2059663240832703483708575053/3504264929316306439711373680, 1412527463837921485198832957627/1997431009710294670635482997600, 2883529561715/3618710874092, 31840510455463/36187108740920), (406164582184814/698700529783963, 29567769067704481906043134525641147/62243233917511292125469974450306400, 14346321721351034403708459255527/19005567608400394542128236473376, 158417643784208679471509253343628169/217851318711289522439144910576072400, 1293024508198369/1397401059567926, 940028817460214263/2288244235042478825, 575725724816301/698700529783963, 40670934068369301108725081878461/46659095890188374906649156259600, 406758429104705034670464385991713739/435702637422579044878289821152144800, 2704253757179985/2794802119135852, 5507201156251897/5589604238271704), (659224656158456/812606860769017, 140475497849559149031799558413081/196821521317995110410795047583928, 97349617359361849640886734867/103535781861123151189266200728, 90706452375409615719664321180899/98410760658997555205397523791964, 807032636335898/812606860769017, 979737620511780172/1544765642321901317, 783575929848972/812606860769017, 2545684475033197099423056248013/2589756859447304084352566415578, 24481079795226639271811599499884/24602690164749388801349380947991, 811457336323959/812606860769017, 1624583958145885/1625213721538034)]
bernoulli_PhiNum = {(0, 0, 1, 0, 0, 0): 16*r^11*p^11 + 70*r^10*p^10 + 119*r^9*p^9 + 213/2*r^8*p^8 + 253/4*r^7*p^7 + 57/2*r^6*p^6 + 27/4*r^5*p^5, (0, 1, 0, 0, 0, 0): 16*r^11*p^11 + 62*r^10*p^10 + 96*r^9*p^9 + 82*r^8*p^8 + 187/4*r^7*p^7 + 163/8*r^6*p^6 + 49/8*r^5*p^5 + 27/32*r^4*p^4, (1, 0, 0, 0, 0, 0): 16*r^11*p^11 + 54*r^10*p^10 + 77*r^9*p^9 + 68*r^8*p^8 + 177/4*r^7*p^7 + 163/8*r^6*p^6 + 25/4*r^5*p^5 + 9/8*r^4*p^4}
bernoulli_mean_phi = (16*r^11*p^11 + 62*r^10*p^10 + 292/3*r^9*p^9 + 171/2*r^8*p^8 + 617/12*r^7*p^7 + 277/12*r^6*p^6 + 51/8*r^5*p^5 + 21/32*r^4*p^4)/(16*r^11*p^11 + 78*r^10*p^10 + 158*r^9*p^9 + 371/2*r^8*p^8 + 156*r^7*p^7 + 107*r^6*p^6 + 991/16*r^5*p^5 + 65/2*r^4*p^4 + 1015/64*r^3*p^3 + 421/64*r^2*p^2 + 141/64*r*p + 27/64)
bernoulli_UT_used_values = [{r: 719, p: 1/467}, {r: 127, p: 1/887}, {r: 971, p: 1/487}, {r: 347, p: 1/433}, {r: 619, p: 1/317}, {r: 53, p: 1/601}, {r: 547, p: 1/701}, {r: 283, p: 1/199}, {r: 109, p: 1/317}, {r: 173, p: 1/773}, {r: 337, p: 1/491}, {r: 241, p: 1/3}, {r: 881, p: 1/227}, {r: 709, p: 1/41}, {r: 911, p: 1/79}, {r: 83, p: 1/919}, {r: 823, p: 1/193}, {r: 751, p: 1/311}, {r: 59, p: 1/131}, {r: 263, p: 1/83}, {r: 709, p: 1/281}, {r: 593, p: 1/173}]
bernoulli_UT_computed = [(7437356646625462592/1139708018390959, 103594783619425371685022420093366464269/24549093837425661713408062269298688, 54367745127552428909602320371686237/8647091876514850902926404462592, 79639844529373987244818962100972619469/12274546918712830856704031134649344, 8859637068385098888/1139708018390959, 13510846901702032932088/3235631064211932601, 9316742430081533732/1139708018390959, 134348071442506309338949328997066595/20699067316547775475048956382208, 134293803898974536556424331539569115545/24549093837425661713408062269298688, 7112237382338581922/1139708018390959, 4414302701089918817/1139708018390959), (41148755813256936/82375531660973, 176665874139705391699080230699545481/668324905775697243575538454744040, 153764850119047255070259712248149/229270979682915006372397411576, 220632665518789103177960831407853701/334162452887848621787769227372020, 197067734080062750/82375531660973, 69344917954322663964/240124674791736295, 108901641279289128/82375531660973, 2350301521451323932257117120022549/1977292620638157525371415546580, 67236341048534046779283849120816583/39313229751511602563266967926120, 284027553522286449/82375531660973, 588566298621767457/164751063321946), (32257625699665265832/4610595358553753, 3506275003152376843037312773659024968183/768941546942787233506169563561527720, 1443233737471534703118935734458617107/225959902128353580225145331637240, 2567642062179955040406005310545945442991/384470773471393616753084781780763860, 35052661285281635228/4610595358553753, 72455210818146738504648/15689856005158421459, 38090025861151971068/4610595358553753, 3352830019845545053192879907156157893/527394750989566003776522334404340, 3984514780109139682435873528901464511831/768941546942787233506169563561527720, 27547957002950283032/4610595358553753, 16679919703162221400/4610595358553753), (502912981169102712/104510222282065, 846672898700790807455594576672340727/277551197368427553903385146057900, 750941520298824459020039079412601/139263019251594357201899220300, 754665704864892831300615990742776653/138775598684213776951692573028950, 846888211146906844/104510222282065, 619598478614639787816/208288873008155545, 770785114839902476/104510222282065, 2283682914684514061034602155408501/355834868421060966542801469305, 428049681893933493154536168981502099/69387799342106888475846286514475, 151644077588121656/20902044456413, 521626292237236232/104510222282065), (4448020344731217384/977771600465843, 859373720911679550443614854741517259/290066929095885135417670381357368, 552489829379732971314775722507257/132511159934164063690118949912, 631607762777035071059898138117717709/145033464547942567708835190678684, 4864235549657157876/977771600465843, 6408745699965456394776/2140342033419730327, 5274514981072009764/977771600465843, 50282461205084357320175347418048055/12086122045661880642402932556557, 492950262477909284751566604798638635/145033464547942567708835190678684, 3827817163637893944/977771600465843, 2321617925493168384/977771600465843), (3631938924645996/21701040603479, 3422565487190773460255717673215857/40234409082084708396478989591600, 4733472160011194703530038092251/21076170289200999683854892400, 4174740964949829091284291416568329/20117204541042354198239494795800, 18714001343506850/21701040603479, 3496593889123868064/41427286512041411, 9951613896345068/21701040603479, 24114788438043306148600044403069/61520503183615762074126895400, 23185448299126167054191277768018769/40234409082084708396478989591600, 28529863846076531/21701040603479, 63044974705222535/43402081206958), (8070039201383329560/1057398953944559, 75247532461171735821093231814375561559/15565535056449269991898757829084448, 41909222458366454935633273173950429/4868794199702618076915470074784, 67538159149424376976224116632002455881/7782767528224634995949378914542224, 13839276875895244884/1057398953944559, 15958494182282907891432/3380504455760755123, 12493048525072729956/1057398953944559, 386222953831999579800745083167191743/37417151578003052865141244781453, 77756731639680859383413826103741433809/7782767528224634995949378914542224, 12474121404018842928/1057398953944559, 8631716846434151124/1057398953944559), (30870303375632232/11215910859893, 3728522456260830150795478363274079/2100420268390550363227297359128, 4871066730543486417526734379131/1806036344273904009653738056, 2911817197422382518590986013259975/1050210134195275181613648679564, 37974565854767292/11215910859893, 22779216840202662504/13044104330055559, 39452596317940428/11215910859893, 12292483743352351877968254364557/4357718399150519425782774604, 5054125027720638945105711420434199/2100420268390550363227297359128, 30735345764453280/11215910859893, 19246468947863676/11215910859893), (390794879649918/386462818141, 38271688162781144648088790436257/63548454558048325244487817184, 71342603394101117144617222471/54361381144609345803667936, 42583512654052038895977007621877/31774227279024162622243908592, 2442871695882159/772925636282, 294205001495114247/451775034406829, 830932449397923/386462818141, 904976425024293658250453804655/447524327873579755242871952, 156995904332356072627245254552155/63548454558048325244487817184, 5673520025282127/1545851272564, 9699835107851439/3091702545128), (6837501393463792/6889331382671, 8988312664432431109897191676013589/16127094619611511174036336719440, 104095798887799083323746530163567/78668754242007371580665057168, 10871523653825761184021296558774209/8063547309805755587018168359720, 27745786339598829/6889331382671, 884300261387358614/1412312933447555, 16633822932807850/6889331382671, 38396853948247281290755035567673/17047668731090392361560609640, 49109058282846155612507847053459619/16127094619611511174036336719440, 73004720746581113/13778662765342, 138808317141980785/27557325530684), (556548326960572140/116062914094199, 35286669255909033939596601315502182/11680378057334826806459835929239, 30275229234396248070885244546332/5440325131502015280139653437, 65487743673266619441741027332938896/11680378057334826806459835929239, 1042729834421899104/116062914094199, 741778941721412165052/249187076560245253, 904153957845718656/116062914094199, 3516445581182931404333845609640838/507842524231948991585210257793, 81003022790834655741104333838647589/11680378057334826806459835929239, 972212535928477938/116062914094199, 692555861188196919/116062914094199), (295605962254332/6544654501787, 340957571731863240358399752261/10829017258931632843505821117, 702186765530829494298575067/22055024967274201310602487, 385256546543738381585287856706/10829017258931632843505821117, 237697437372336/6544654501787, 124230074858103564/3213425360377417, 277404526242144/6544654501787, 5115422948471742439898118738/177524873097239882680423297, 230324759339801537523799878363/10829017258931632843505821117, 178304001114258/6544654501787, 99235540945935/6544654501787), (16369434727125631804/4873921103159531, 112292854111385491199999184159000743409/50218385065927213778958936820157525, 56442864151040909640030208065870631/20556031545610812025771157110175, 148601133283689954235077598059553130346/50218385065927213778958936820157525, 15276225732878359536/4873921103159531, 28877215261550971889996/11906989255018734233, 17365664104445845216/4873921103159531, 468455440421680774472507516307072706/181293808902264309671331901877825, 100378194490469417380096712204383648803/50218385065927213778958936820157525, 11684133820940951314/4873921103159531, 6793329472682164975/4873921103159531), (90696616919072988/147592218829787, 216675073982725525788147587143324471/511609346239789635982908958594000, 148453325843977232318493788552269/331998277897332664492478234000, 127015054159597825110024375241277279/255804673119894817991454479297000, 74987981616586314/147592218829787, 114974187160365762528/227439609216701767, 87225059842652412/147592218829787, 832324138139467094709997255309521/2046437384959158543931635834376, 154927633002342123594992333746180183/511609346239789635982908958594000, 56454711413427423/147592218829787, 63393294652634499/295184437659574), (387677577308330934/327954002434345, 7990351246316810934485914441093360679/9871782990509720375436903189487200, 4202040333831306318074595524121379/4794455070670092460144197760800, 33483804075288597244454995675922644117/34551240466784021314029161163205200, 652210245606270461/655908004868690, 641627660611630273131/675257291012316355, 378436304938978717/327954002434345, 7978895463447202452508553409260969/9971497970211838763067578979280, 41389492606375776972868265561946095219/69102480933568042628058322326410400, 196820544699996761/262363201947476, 1110905415444879757/2623632019474760), (46943553610408872/181936809923663, 286035963449179525399834981520593259/2175953038647671749143564098565168, 259844429798577779195649958314151/744424577026230499193829660816, 352135647593133405039353565207341275/1087976519323835874571782049282584, 244463483640633452/181936809923663, 70008125668638101304/531801295406866949, 129557640259040228/181936809923663, 1330283544171456782265545243302217/2171609819009652444255053990584, 1963463118174413466347564272869338999/2175953038647671749143564098565168, 372955689631486700/181936809923663, 411478491968455426/181936809923663), (9790703779210219536/3421848265568023, 164739176610119939233872709448524639059/86225773627207565615549307973840600, 89556443966654216919157082787869229/38753156686385422748561486729816, 3475274723433101492120559529684795179/1390738284309799445412085612481300, 9006930719277252492/3421848265568023, 15919058044392022296816/7613612390888851175, 10274273493016967820/3421848265568023, 183690095659197171436825412104086033/84867887428353903164910736194725, 71848339320192959948151472611518014047/43112886813603782807774653986920300, 6874672277265923172/3421848265568023, 3981384792815328570/3421848265568023), (2727838604887599048/602677086154499, 10724427710231616444455968426942228099/3613761746752253477137898186667880, 5913766352069311494842053071324487/1484091066428030175415974614648, 7601140237913971728401610804869806919/1806880873376126738568949093333940, 2805995635088435934/602677086154499, 4498003495479433146636/1467518704786205065, 3103976923491754128/602677086154499, 118933952711825744605853036621860581/30625099548747910823202527005660, 11219763375069849967358815446017279029/3613761746752253477137898186667880, 2181249993509087133/602677086154499, 2603324849626694637/1205354172308998), (1983297079160/2746050343, 594403952672857291824953643/1345426487170596287198980, 2378853296527904081616587/2632928546322106237180, 616477523792003615072793687/672713243585298143599490, 5062178814732/2746050343, 643382872289800/1403231725273, 3794874581012/2746050343, 9068393875058394841647185/7081192037739980458942, 1947084557384080018085527509/1345426487170596287198980, 5371612038812/2746050343, 4264010658866/2746050343), (7319978104214768/5976539973949, 86511176558686382505197237300001/106829407265376714520249108100, 141941757059513298029973568201/137844396471453825187418204, 58800516527429323398139740631761/53414703632688357260124554050, 7072396742297736/5976539973949, 3985964996809652248/4631818479810475, 7969548203623100/5976539973949, 302825927537906862887204366527/308755512327678365665459850, 81995324237212280804658320129841/106829407265376714520249108100, 5437014166736846/5976539973949, 3190975965646415/5976539973949), (732845490653808780/178779220794191, 5780366280303087134464394098618731679/2147694821197480208756639707502640, 3401274143959266581974106932956661/949887138963945249339513360240, 131226321949537726245337256962772681/34640239051572261431558704959720, 745475587303188954/178779220794191, 1128822763165565370960/404219818215665851, 827479625000830524/178779220794191, 22616839828798226349173272242413385/6508166124840849117444362750008, 5943730947621269873458895662604806327/2147694821197480208756639707502640, 578301688405493919/178779220794191, 688167754143467379/357558441588382), (876842186999432108/343422713098489, 5027893724261934954750988691165783499/2969745054168106180719884798722880, 3698370677292201055042994990717509/1741785955523815941771193430336, 3381457934234184553620967984913219499/1484872527084053090359942399361440, 835525398458190486/343422713098489, 1061990029293196078408/585535725832923745, 944832736433765660/343422713098489, 7802373619007513502875282066815003/3876951767843480653681311747680, 4655209557443612819854141315901573199/2969745054168106180719884798722880, 641043949444416401/343422713098489, 749652686562805525/686845426196978)]
bernoulli_unconditional_times_num = {(0, 0, 1, 0, 0, 0): 240*r^11*p^10 + 240*r^10*p^10 + 1162*r^10*p^9 + 1178*r^9*p^9 + 2311*r^9*p^8 + 2405*r^8*p^8 + 2598*r^8*p^7 + 2838*r^7*p^7 + 8031/4*r^7*p^6 + 9483/4*r^6*p^6 + 1193*r^6*p^5 + 1570*r^5*p^5 + 1049/2*r^5*p^4 + 6511/8*r^4*p^4 + 5255/32*r^4*p^3 + 10567/32*r^3*p^3 + 1309/32*r^3*p^2 + 3557/32*r^2*p^2 + 249/32*r^2*p + 921/32*r*p + 27/32*r + 135/32, (0, 1, 0, 0, 0, 0): 168*r^11*p^10 + 144*r^10*p^10 + 764*r^10*p^9 + 646*r^9*p^9 + 1476*r^9*p^8 + 1269*r^8*p^8 + 3323/2*r^8*p^7 + 3055/2*r^7*p^7 + 5123/4*r^7*p^6 + 5281/4*r^6*p^6 + 745*r^6*p^5 + 884*r^5*p^5 + 2607/8*r^5*p^4 + 7323/16*r^4*p^4 + 3221/32*r^4*p^3 + 355/2*r^3*p^3 + 1407/64*r^3*p^2 + 3393/64*r^2*p^2 + 121/32*r^2*p + 425/32*r*p + 27/64*r + 135/64, (1, 0, 0, 0, 0, 0): 208*r^11*p^10 + 176*r^10*p^10 + 806*r^10*p^9 + 682*r^9*p^9 + 1388*r^9*p^8 + 1204*r^8*p^8 + 1512*r^8*p^7 + 1392*r^7*p^7 + 4847/4*r^7*p^6 + 4861/4*r^6*p^6 + 2947/4*r^6*p^5 + 824*r^5*p^5 + 5447/16*r^5*p^4 + 7045/16*r^4*p^4 + 3779/32*r^4*p^3 + 5899/32*r^3*p^3 + 929/32*r^3*p^2 + 1873/32*r^2*p^2 + 149/32*r^2*p + 421/32*r*p + 9/32*r + 45/32}
bernoulli_unconditional_mean_time_from1 = (616/3*r^11*p^10 + 560/3*r^10*p^10 + 2732/3*r^10*p^9 + 2506/3*r^9*p^9 + 1725*r^9*p^8 + 1626*r^8*p^8 + 11543/6*r^8*p^7 + 11515/6*r^7*p^7 + 18001/12*r^7*p^6 + 19625/12*r^6*p^6 + 10699/12*r^6*p^5 + 3278/3*r^5*p^5 + 6351/16*r^5*p^4 + 4565/8*r^4*p^4 + 4085/32*r^4*p^3 + 3691/16*r^3*p^3 + 1961/64*r^3*p^2 + 4751/64*r^2*p^2 + 173/32*r^2*p + 589/32*r*p + 33/64*r + 165/64)/(16*r^11*p^11 + 78*r^10*p^10 + 158*r^9*p^9 + 371/2*r^8*p^8 + 156*r^7*p^7 + 107*r^6*p^6 + 991/16*r^5*p^5 + 65/2*r^4*p^4 + 1015/64*r^3*p^3 + 421/64*r^2*p^2 + 141/64*r*p + 27/64)
bernoulli_CT_used_values = [{r: 499, p: 1/863}, {r: 229, p: 1/439}, {r: 853, p: 1/89}, {r: 947, p: 1/337}, {r: 19, p: 1/647}, {r: 487, p: 1/431}, {r: 41, p: 1/433}, {r: 139, p: 1/719}, {r: 827, p: 1/281}, {r: 139, p: 1/919}, {r: 647, p: 1/199}, {r: 181, p: 1/683}, {r: 659, p: 1/53}, {r: 151, p: 1/293}, {r: 421, p: 1/857}, {r: 547, p: 1/271}, {r: 773, p: 1/257}, {r: 607, p: 1/157}, {r: 619, p: 1/733}, {r: 503, p: 1/103}, {r: 853, p: 1/547}, {r: 449, p: 1/41}, {r: 701, p: 1/227}, {r: 271, p: 1/461}, {r: 467, p: 1/919}, {r: 571, p: 1/691}, {r: 17, p: 1/227}, {r: 367, p: 1/569}, {r: 653, p: 1/349}, {r: 233, p: 1/409}, {r: 727, p: 1/617}, {r: 167, p: 1/971}, {r: 389, p: 1/397}, {r: 641, p: 1/947}, {r: 859, p: 1/97}, {r: 37, p: 1/331}, {r: 317, p: 1/463}, {r: 439, p: 1/983}, {r: 193, p: 1/149}, {r: 271, p: 1/53}, {r: 677, p: 1/877}, {r: 863, p: 1/563}, {r: 631, p: 1/709}, {r: 653, p: 1/379}]
bernoulli_CT_computed = [(10696188162854218950/592197983612197, 17386016189015353239569825584360976624843692782202037559436749/1187508359955467260428158922415873438589887059924328396520, 2644005129112506712130294868928482287565241681130095347/177893027339826209911719079063774454290185910750360, 17316796847326491428355624346508858378967704776175446349600853/1104029535313449095759827605195239410860198664533172930600, 8322428298964182310766666/513642328888055455753, 30299369824853556941901388654/1842435033721454919786011, 19390450776335516846862/1102080447502298617, 17006787748355037236737411061877401746824934664369286836438829/1187508359955467260428158922415873438589887059924328396520, 12588419219192834911972981311919005971275992565201882167694278928413/1032553193747482116071266802716010240685852736466114366575182440, 25774166122705907179412523090/1918471886839918870410941, 3969221486730286650719809445874/448623166379379158808026647), (273759278637292365/31337946351739, 95630515500661056056734041113759610778406136154174479821/13559371151145627922874402146691922825298763905436450, 183007998127714815104132893372633482264145576877877/25548770363456833431389895231413486881716075002, 32725623997785510410294388546567418081499749698426027977/4322773924265670223321585534941409981652590457773650, 148048823408410135635951/18913923506753018233, 266672564962237411855819341/33572214224486607363575, 6131375107276763343/720772766089997, 46772667959258233287345167387028701748371001594340335148/6779685575572813961437201073345961412649381952718225, 24263469955716071491814961909446178019780702439150186896660239/4150844250186377179015702245185914412911338855564982311800, 24420895442510278366663871/3771302947876521753085, 26830581320052596276236329879/6345704944620944685588289), (761454400782188241/544510501520978, 85360459894795456445682412095535035968762768940145297838499/85850079688118682796886080761233350420838876109043475368, 121407675628877302745660136442799910979204094994082113/121204618460806801001382283051322873303297688868024, 260516474413098804154076899280848967818681394690366868332871/235197072819484718174247193955712120666820125926553392392, 630346222305420764526997/557250413725064322266, 1328778608794341891965517665/1099455066279551907830818, 1283650827569738048523/977396350230155510, 78401135282115924751695347446820278957259479919509652545451/85850079688118682796886080761233350420838876109043475368, 236577328053486004918815419663776980951568045741539239900284569519/345060836771864223944298879625299668777130345814250428483977224, 487426763668179382062348987/570478296093725188739414, 2354155755420405947948846108391/4866214029488589320015433118), (43719449437790990748/7412780344110157, 41201592607794305277321572317635772361445798659938299185854538/9448304740335283110612613362493604435160606477280392539255, 45172352499216819766489921481202816317349184106318784804/10204840598073458993063366000975957007944577748678687, 28936738232253780989846841507415994182564745314346257754540978/6037866155896036594294969197544488865603053160779485389405, 52644880947874255670307928/10721556391287510788677, 22830406338418794492111078648/4449445902384316977300955, 92781696013474106340052/16537912947709760267, 116522434552323740905144200435597391501846820249751802566876824/28344914221005849331837840087480813305481819431841177617765, 18690666598249758235784450189340361672806034580708693704725580114731/5805649490274439907164296318022024456086795688062450110929601260, 231476633722100729213834533112/61203590926449019344914935, 259276036991087912438055027508820/116015210645953132724979685367), (15453694729036782/29228313300739, 250124757801082559816554872159749399880843034479388047/823729583948720111285782976748456804424283727989120, 199079803792987124873922814776163470894397276881/607642718580659044998604306346902921865193088, 3241833345002260358214342982317388874277615718437652521/8532747263558320416339232826613981659407664025526912, 1720469395088603641946/4332015999242429407, 3539344021752819495074926/8573059662500767796453, 9678066391522445286/20021394611006215, 692757728450293959233242823402896680457392717275033261/2471188751846160333857348930245370413272851183967360, 190024232040054633986348989708412266782698978433875305780173/1212641877216246060935648615344679758152498510128944278656, 2288606500061562986918994/8410046870536993629395, 591954220162185577614761682/5441361270245717527934069), (1791808419549658887/196929326142502, 1541717157552008838642650860456355199020117740693505077977/215000325089490333717217343031527324830146764504621780, 491658391839150638461615865563325364018237878094111/67501165598786341463459898255969472198241758828, 9026950976172130557973468648584974445123266751308488850259/1168750224949315335110336513300331710904875305279426588, 16559759658054087440051/2082133765304673646, 38424016403209389538558801/4720197245945695155482, 2433972314532931068027/276685703230215310, 13428481389184975584593628606611888631525351022057878469513/1935002925805413003454956087283745923471320880541596020, 4203645887157347519328192057952595429362381101386254398639991329/726564829453661534144082411045660707041045270901135561374676, 2012147818189664451080393631/313882499115375765630470, 116142226649740842240618810267/28410638523806668721283502), (10475008592592645/8499186760972, 5543205650120184059605306621147399237269325556305369/7130155451520939737470376551395639434820816522130, 8229704893215276650664384781946506288004597259/10025316467623629616178478450813944355533582, 8935959556713965781871741721367821999228616548935417/9615270860542132636156458689555326182105406512554, 635318531605456905265/650808227847908956, 903300488711685287342181/898766162657962268236, 5056055821375131583/4377081181900580, 15730766087807425104822660621982081596220881583550377/21390466354562819212411129654186918304462449566390, 323693877026952155309375436321746966926872418795435667289/702507359933772431894904703371616355036873902455537742, 589006041567128195719739/850086067580457343540, 113460279326424736282712075/368471533990031965747892), (43062756606333900/9006903230041, 40996713261124859561516632240061606841066680066004325683/12216339134713978304075480918686610419889450491347440, 17482530350546652218527365557061149123478819148317/5032073277209030913716706966355580260242514192, 56494309240136214915806019291520960231224301178393131683/14771430347669091195043128218194623096947778580326640, 9565443147380472655208/2384208347120923069, 23785556854726474697175448/5805547325239447673015, 41068490870863848348/8979882520350877, 39522551386239374179592670710461214187880579662656833203/12216339134713978304075480918686610419889450491347440, 8767689427150784191281759619976919648272524143004544812166103/3767174807215317058843835578630620798648611383675420251440, 16081488941583527885972472/5336250288305906902865, 6015536176866853474023210756/3890560538923316147522831), (18214614773612779384/3728405003274989, 55616986330358536825678447824252192328184537541530995450154558/15434918676150354012905887156174887922064593110723896749815, 11681821622974334176940030809909956867709716871043844584/3194514280423402969952757191042664721606929475209817, 38781147143894595186764625933053008487198609160678222865373798/9784886791322678614573742770461961267291873569477410796621, 49638160447549686766941484/12227121516395165951039, 129663693024653685133103505324/30531122426438729379744383, 33501937061889395651464/7214463681337103715, 52360162767962739383994970233984647745986590472449441958337998/15434918676150354012905887156174887922064593110723896749815, 18918152862491529220697982732741257736399600653359319174441418064909/7139122696670943187156976760559577044882077170510062796659029616, 63409851716146279090540190092/20306384991194875073225055, 61853193198573061414062094731304/33610006782301036406962281239), (895258747322218500/199323292175837, 5923200884772915443552910461017421727775195356182406273367/1954842711386188590730223244725010900975375427205063160, 5100032960282305746258760601675510896453352170113099/1614285063058130161260006065183560962517806400024, 8677128758922533125682695349272156566342957973159682653167/2467648958860812900740997703294267341207446255312363960, 867199203373298949585168/234668693607501647699, 2694059814712446988090774608/712219485098767500766465, 113207714017548046004/26509997859386321, 130609792848603084476871835748750068378145204441442969540881/44961382361882337586795134628675250722433634825716452680, 5518661038435591016788762835294200982065933753197299834696847141/2781291691218104034880739942409401714280810799138051676789480, 198859934328970327230993568/73314326930057949246735, 266977836428789823910834802892/203318120825606359787589467), (1829755336878095655/535953878889896, 2463664959463871714660482026081356369716412586655123572107/983242842440882394618511647753427174046375414445152760, 885091895684939576888301621270237993046362016574149/348264700256717987172470877758617307011913312520, 1692371883591208199005610599130017567073781351696020193079/613041694987840738223000952015360267981372908630632920, 995474098220941350514955/352218706082740743176, 1973840865089446985714979201/666045573202462745345816, 2592746830202584360499/800179141182614728, 6938605543919914403070231009901119928375588407931932133681/2949728527322647183855534943260281522139126243335458280, 991170953752343408780228599062172238140218670766389729079690081/542212452394431790736698449486492101043843717335775617234280, 2973533102111381102969260015/1371536654615225400536936, 451331169546476033826901765637/355121786990980961912961656), (776503788313888665/114465067086857, 273680686416569934408732567834346520583921959361147535967/54388016473358660996648001109796018397162859709100520, 111514216417735023563029772291099442833269453374457/21586872160237929028098091526197122199949934296, 20310476589139563159117037116057479089427282749849871393/3627068749476082070637701989703838071476251190164376, 188593268588809310673985/32232561636189323201, 462887890897895686516595111/77712706104852458237611, 782363632402853375793/119615995105765565, 4782307671399455953196932705081023483320204114923057483661/978984296520455897939664019976328331148931474763809360, 31981660552567187717218387214110782613453874005362643147494901/8503661802722826666665398896984978967696317785733162783128, 325683003847374603034803789/71474504403533415351145, 129569535554925675152293558755/50782741298788622829483187), (854104113099961900/1035957614001419, 1189055343707007896670623197064814626183039213587479337013/2036080886114265133818227448090817141583109119225436900, 4134681266338907936164760259688312769899142066124173/7038418997840387491118419281220740876805283164900, 41936557219934096123920655352312554865309495387302013283/64391172530272830238590846688230023561298824674275900, 1246751090177073494973616/1874862622370786087753, 281915955857783280010919712/395596013320235864515883, 1098061898356171890004/1420297888795945449, 1088418042380978095281113280838393226117599921278797349113/2036080886114265133818227448090817141583109119225436900, 190918519909865787243227306452888371000356219467612655089106713/477770640653163515314633613662828917742899966011131676656900, 1239095561601815146306888480/2471223166546395752914917, 184137254537564744414552944628/651416061542403937174490629), (23423061396106530/4038157622357, 1175568526941591399046710618523512779487077061827034/251287514562693228680448614829521714186034465115, 28885518510247040291454885881328261047609874948/6079291509923629579785862219173139329527869, 20590349570419521435015256282459393593694634922759294/4099234928622158920595271999519306543451414156033, 1856415832952746150630/357429445627685141, 2225101868918693668743686/422124175286296151521, 13567569313477997838/2402703785302415, 1149699496050529277207688219229306071126682324593979/251287514562693228680448614829521714186034465115, 371935365630919284155620140601369556400270234221324852982/96028008603784886585450201639824680615207103922822501, 107448807254099719074642/25023877252891087235, 442975804884108158098812870/158234012635559305222447), (12755948924311236495/779344904213606, 1295037139320821816723773195959652669766924580701315406303323/98302254528384956302894632064608244525235844200102847800, 226940289082263343894720769769779105531237762192682229/16952502269631893617105843454666245052584463379400, 1353694764143431989385921418410886305516709366113705067859331/95568014526068832289498460039881417457384899270893604600, 8243296685132489720252971/562429057678928828414, 28545037036828264804293469919/1919570373858184091376982, 21103307629764567393621/1324106992258916594, 3800866385831639542619738888199588743742646623624458078345369/294906763585154868908683896193824733575707532600308543400, 46379269935724670171301988759711721230324114693986535440488541043/4263270881776682321460918637415538850884403251772236884879800, 23126778106663290983094579705/1911233246017419577695322, 289533931623860488243395846447/36902708811696162826775206), (1309164224459613282/260506434392837, 138798418477953845403680396023659797049514937588875637031/36621679405726374913444194895632074758070902625753720, 162543028626254705717769946567700780925561876287979/42206191654490252699360015323109279010321605912, 1158237082336255096825658575728773806306723893252324119/279961822151178439650823888369336054944829604101368, 1733129073497516782965282/408148716591411762587, 3427188708784449441892621782/778339602539822231253409, 569689936439995194974/118530427648740835, 132101217664186828440291711423626308874442391787418729351/36621679405726374913444194895632074758070902625753720, 8530543289489889340819253938463834406664724415973011447632949/2958697323637812024160064894684611755968725731311517361256, 498448775018144244737941242/150566476042359561661295, 991161837564918033986848553022/495564236790740194101784787), (11797779902661221671/2648383231018370, 814608544344069084350995996986700842260798807946006147343079/248204445734779220759860443566701776561259932133171673520, 1385084043974008176132522629290736629864896797358195263/415897045935155440428859660831648120137568523982640, 566129333747657036286349043535890399917921731561432400246391/156766075777744761207597219789341641236369142935293461680, 27951042941636229131059657/7557127120728915556190, 9683514453476238628037308107/2501409076961271049098890, 20212329897479784656773/4775034965526121110, 153285303799515532195626178766391090118894192969725667636843/49640889146955844151972088713340355312251986426634334704, 480431203435921092678466352913198593124782635966890068091845725163/199406518885146821067434293199657349953125016301286038681209840, 6669087081727346315252997029/2345654751220293051228630, 30364594351406979380906333442481/18143464720388687670209576270), (1997450948586699678/757161963197437, 2986536319394530962578470350358552756714494589440555239728/1554210447574319153785718805910369036713497254254583685, 3929724148106363623183785992351920934134152242281446/2018337171950105713024198333747208327712662577193, 14016345696644375355284148059644134069677226415498210455096/6603068692729699305170704526022828250375159773411437545, 2777285304155692061931414/1278879113804888582791, 4925485379043998953532213478/2154911306761237262002835, 864334316789546728374/346023017181228709, 2791071978236506248478539714563929852887819628474851811993/1554210447574319153785718805910369036713497254254583685, 5263982460585633773442393712688080556087401573541098882839847743/3802318427897620040110341659881714761742342365575328892386635, 860325622512978355850233154/518496459980126252857505, 1822304754312305581626004921530/1888824138565275123900119047), (28512116316140749200/1758382107474019, 514767462057825202325385511589142030162969234685296413060347/39478578923078209031736630058043500468238192385213344780, 14577315277917332314912868252220357513428042116705851969/1101430653770002762931022237481335280758814618899460, 4159406723090377131665144280004897174134491991695183268267461/297693772029619720803817279146291984593311141621245361460, 75410793442386364527279756/5235384027825747008353, 37710877514856069004507101732/2570573557662441781101323, 18196280480436634558768/1155257044610430483, 501411555126771512839110303974120852081483729292206544572467/39478578923078209031736630058043500468238192385213344780, 5479095168417762233396490984839058921779644035153104198128456010469/508677225444268056512911761443962485228887740864710239764786660, 3141562059331368638522037140/265700520013511355663071, 1321666546848418151698304742768/170707534472226334338248839), (34675652726827989/20498212578692, 10738073088380533787156950500736115666590312490950526493/8788978778336060925181929690809446892233378738300990, 7448971825624776182878639494075608377817069928031/6026721417463107533716141826678675950473230594, 6990646235174695080956344909552460723451398609064851873/5164541542281569244007744402570535323048113008819990, 10648421502193524361361/7695459464505129332, 14807988717426017309524851/10119529195824245071580, 36310201924117279385/22732517749769428, 29937612702776967441425211456951349479032228021847317099/26366936335008182775545789072428340676700136214902970, 2329862113763687343257470929313457607354414841395672416068307/2686137457043597111183549802091608932149295272149336189610, 4894829476767929273008601/4649459122842591339412, 14186794037428173670703139211/23389086479782891503670012), (57028000135432670721/5324249142554365, 57370338602039690263571081833890809540641151330854120647902166/6969573991873552500575315479040955065251826258934969400325, 23197546900563069580794927971940197706502911169704404028/2772749168571394897660729018629857954656942325653225, 4069992871059811389246015581571259645453987676737187641138744/455632679066232905176458551023627792270414200118807230425, 202556983377259869326100027/22057443102501072289855, 698662486446737619141473765829/73826262064071088954144685, 41162155732990955772811/3998511106058328115, 220135633598701484194612868728373594514123523578271015595103147/27878295967494210002301261916163820261007305035739877601300, 167119912908726753727244980568394457762585246332952773368285118931911/25991897717866982276685420488167971948697667656770540446033499950, 18620154398613180791848247139/2566760235800916508533835, 296446078946325087247235483423691/66160053299613817764309485215), (98095887893197441/152973881007260, 253526326140440731786413362564438529554991139011996569/557276871841006739418460529556204830499456893449770, 266141359608287874963946581439909284509198502251/581272376828879723274974762736740202811727830, 153244326867203180695624998856950183627604872849955961/302245467985708091725657924570013983916250534240930, 66909615970061458062343/129248090984676995780, 73126365836610303880550043/131962300895355212691380, 86417127089574121819/143642474265817140, 1626496401662392273254390333705938325243268107160061429/3900938102887047175929223706893433813496198254148390, 38296197482975100998921847963874632392907249615845267716217/122642452937072039737196013035755211641871684679111078710, 9067731987740005134112427/23215065763418568715380, 22995841262176700856114671791/104236077545376342488081060), (6335828740413591445/1615931321717681, 81035596757204113029658269493164219122747465472493884977615/28090245375772913708423335538820304683510039576590756808, 24229810490467094853651250079302332523098885751465145/8278376584680190070462348904390538120282682305144, 56092945580866613910560919643739586180661829023100366465537/17663319213773327401353866367016286740887449710211967288, 12272586506079083802830263/3773825001632289877547, 26773399176985919642006312457/7860877478400059814930401, 9803120247171502479061/2632352123078102349, 152369040703175211626688649761926671717071038784161071964791/56180490751545827416846671077640609367020079153181513616, 19471490546254088712677943536163166186178083507181631987309420229/9214274201153472017709806217605520456023618366806205993593528, 13263916531398836637959671105/5309804335080901825545417, 2187366621195881873888848380587/1489727271955461258224928271), (523728033307242246/53824077126461, 6891076144056361905164483628377727521403969823834601928/873676702937670818963954864237902357113855518318075, 177517764074113742927003563168272768821741390226630/22172525770193766818626607630437112298729225517, 6830630856823638204449156380802192942677567858977039408/808558900756850404483522899159859346313205967863825, 118366865703884600585530/13566304815647368589, 4720580840796434149116842/532961974900432337425, 511602496852639189146/53985549357840383, 6739213946003113975763257178779129510051868019560396203/873676702937670818963954864237902357113855518318075, 361856607651231861608086521293331723768013838108251415228667/55086786530469036850858258615539905051233917895399684925, 15208920473262218686572918/2102467219741093715935, 82215581759297037522511342962/17244957916662272530922311), (10664684590529750430/594071976772271, 1747541058743501020214599664324609000378264800128416094322121/120691828460906783694396634591294550231084549624923082160, 259571574526988355399359796466038597607332377232049687/17646492761290942773154494844271885249835336931920, 1808218403256545965683358129360567279456645970615160232461817/116259416709046052205368496774353603168554748900565052080, 8203838842802761463581850/509963860372829644091, 30722781176357395700196738126/1882276608636114216339881, 19246281719810518652534/1100815372959018163, 5129306611191908658588493712901539870258956558563378942052123/362075485382720351083189903773883650693253648874769246480, 1263548654908384690497929126830678193134194326702918799548412963893/105420893399049585633968999841844112119546946919467815402794480, 25137206418629592681568600690/1890008627694678587363471, 3791594734744645195960849116602/437801933606301784264742261), (4625959182108373164/302157653339869, 20913482818135011425076061274387118784434689992178533186894267/1696789859808505479572409478757353321259112095877371633140, 10805730958620705000966353475319966764838266344556944415/863785426745286888929709844533655059654958266858436, 203024833445461062683680849712161296536823278555683978247579/15376366706581712364997952970214887000305978499649811380, 10574196915285684154492680/776776924003575009523, 34614382371011888378674578936/2497337810671493655616445, 2746285339900401803268/184618326190659959, 20378340573411127021781693500142200607323543589680333545106747/1696789859808505479572409478757353321259112095877371633140, 42865738507496948781354212782823918605171072332691176955622886611031/4204787242685732400756834368387401618313338156366958388266650820, 3679634869714146087268607192/328924317765958362652555, 8772516304121801215148069255268/1195783063571455917561591139), (168307801217983/327912993467, 16943763542769129402927423744580964313885474521/54184625750126702083138720950947541125409630, 1059689802674116668098611908121650503876089/3193906616570981555151118240550989750982, 28344181859900268978703305929186962120905425591/74990772141653044771762025898620002294556730, 7834952782097105269/19806928544387201, 527256621954615420993/1287450355385168065, 40653141139145167/85585291294887, 7917377629999046770719460289444105065999508383/27092312875063351041569360475473770562704815, 127015370439849938316668407903809536492265194930047/720641646877772120271972718116932997008431841260, 1245575072621225456587/4509061071871121595, 121326967517850141413965/1023995065252782318977), (2477773628930734110/200427847170167, 5740347305227565917333908156619561228423203844199808503417/572449279999773884278976935229072721727908387205881820, 1831576408675992744236471241835769518181521614577999/179980236576222294902280759218892877819190890340, 5541390812576633447951343129581758673782880334301737774559/516361403582634911932321639110842792412369412793237060, 25604191084720316391250/2311534361413536011, 63478386148225652991793946/5642455376210441402851, 3143690715387116728218/261157484862727601, 16832679113762851154124921617531544695325050915602327455521/1717347839999321652836930805687218165183725161617645460, 59479563434351238774132567927112341444764233665367689123745529/7115133624384540661626758767208671159040080868667582558940, 50436729898448465398871430/5493970009057200542237, 226137581011406711746483716354/37268923584838992842713097), (8521458404678591007/1297067468362216, 1547383685690307623035296321741004645526323876731880581309/310651623683383997036467277400830499550412766444037832, 365457622032779783073892286113400550531573522750263683/72194195603854054621535504857269463060751281999544, 832450855468999831358351212351710283939134394060731342563/153358881760693232368975178056761018174806797879674296, 5502562252339627522352299/987168217618710266632, 74038229543734449094998735/12833186829043233466216, 13507291324603796103241/2146646660139467480, 4428562254179007695909935616370075261196468969980846127711/931954871050151991109401832202491498651238299332113496, 234543285735338241472452529609148772552600107523427564714832587/61425807770936223801004526496889677845448899814929735208632, 3421593938976997084816032337/784572306533057606649752, 13632041954927816398682779746737/5142499784817144413218900376), (232222828520546877/27244384236856, 5270064922877318624417026144251732876066877753106757663/763333081008372778776540728181958953455887561592600, 18057494939633785174027561659919058634153549388213/2576434329620699616155736151149975372393511304, 26358253079115491830927397421408551530084326893565936071/3562955735245990111687011062929098960536052048509912, 39909735450195858790729/5222121837367847512, 68583845684967710957730405/8841052270663765837816, 28270132750672920553/3405548029607000, 15462978092129539877776003537602449803680525749878465189/2289999243025118336329622184545876860367662684777800, 4220078792543462836185799135905761918430504731160215717985329/734628410431435363386491136251461730855829928627543392424, 11610008144036711426962351/1832906135001236762600, 20972305864903899454541920547/5033049072216548250268616), (36472655173123825578/2828161541003507, 296964572242963777498088289842696493323067582699611358669074877/29310360734968736678756392613345809777895521861839584607520, 44076055518415214258701635780470624472264320724207881043/4282226165521671534760538349025014376604156361692384, 246043167669046310365335476624751991575516424138724331831101187/22524948900600508220121770234925351533248078456528104209120, 35961266180827295602377958/3197635392881746157987, 121740370406399578689414912446/10568184973474171052147035, 72980224481489466941022/5857122551418262997, 287114982537767185155424411728513491156901031303950140402349607/29310360734968736678756392613345809777895521861839584607520, 125162794611386137667931409050440105127288462098651364735248244402819/15370560134242979736453473750541858678560279594003289216942998240, 132102054400900198153699041642/14612378626891039616230585, 124326682176981935248161331565550/21656267331117483995930597137), (216200706919700021/38870499912961, 260398473124957933122280928652551917520180417180058740737903/67985190343598520284741468373515528442498506742555496320, 63837886327604425122835575732085999747565944429805929/16044327470827423435895785528761716607843964836992, 369789920134886308028460162288983226729866831979946732353583/83971424765408361573926504994101499948688411653511491456, 247838245554414277778831/53591185805498373271, 822631525562678948581336761/174010580310453218010937, 269158242667281642341/50726002386414105, 250421019162159096505589151749214856504153562515658320218223/67985190343598520284741468373515528442498506742555496320, 95746418772914216677529249705334381345249874120839371139103175683/37046653804688259185994989154966995591447170303226647488575872, 183683786387637822137485253/53485344738227873069685, 89738007014435231039964517331/52418003050062974926927831), (1254121430812419459/145406389266508, 934811506570750619057066308898927497637709713574367751919/136086485654096029483616011221771272366657482590873325, 410250909229519145992827637347546478630926406719307/58820866258537557452693779636178326774216302731, 808664957819058178180500128893599635419078071895525522961/109610715409044227456820782378882816188669216510223177, 394861142302483342654927/51946868784627782524, 793732439836697518661229327/102283384636932103789756, 1428104328012015567637/170852507388146900, 2723188810120486999385823929584999978099969483807457363582/408259456962288088450848033665313817099972447772619975, 258226527900679803878169076450905880766215327670417200862084888/46008330360187031718253974503833206455059437202008837355531, 806019848749864030317411473/130342181918865552981700, 419955720718797305238470484029/105018199032568490722324148), (61566689260251446695/2965161009448331, 9825873717923794627466652278213577871031927270667812499330899/583610379033127447425294108625244322796254455330378564250, 144308120212686663476407268526710467844319764717767740701/8446003256677049558246777936370198162003132539260750, 9358507938125346988895823788407219825703489719042281262530653/519454087745492998476687747502763103277286032506773544750, 29565744822066824131394539/1590337420968527296871, 6518177994949190120321919879/345103220350170423421007, 133604204702176214944711/6609343890060329799, 4800521666046889721324071487192180397291000720314440553436637/291805189516563723712647054312622161398127227665189282125, 5047763323966730473926648944422759927634234769796534653705490632949/359737559549167037154491109662842576745414674745028409346570500, 258502477589824199042573150755/16789934392268627779283067, 48668399778417685371191254144577/4781895041886220049578796221), (6066362382199568904/3965483725392313, 284269504103738882414537622877474726543066972937491432239103/260997116257349372641598712975193656521001152058513196345, 1650089832896498354317943865470485956802366423841522679/1503136558051944438860821337721045045762669692507347, 19398158524095941628710323181181787634421166620635552581513/15994334862937458091417252307723738149023638713685429571, 15362230769776508876711436/12402363624378764900227, 4705936599677839627261389108/3559478360196705526365149, 3448589734525619874984/2399117653862349365, 261389120924559032809572031939164025742112930519374409269143/260997116257349372641598712975193656521001152058513196345, 242223588108695147035195292049347631432170167664393639140701796239/321668497377661943624967694437744541461196869134865456759748078, 6650245583723678284769962436/7103626632203607692357545, 19436772708112938272942701989144/36612442723800420229323603883), (2606649094740849/2272446430129, 103847413423482730862981654788644529505263342013201/140820021078586207402648087871770178165627551140, 757783510949508393998423537876593593100370829/977611309511515202906370147327364213722292, 162271024312787430172143770317924512384536790399031/185930878891560933243178635060869307612316017692, 290596481352459059019/317076722842329499, 318882446804981945363469/338320863272765575433, 330836594275579043/306780268067415, 197055261993517062512313235025151292614556280678857/281640042157172414805296175743540356331255102280, 5573066436905845620539504959488604352030719635632938479/12380659467821895186230935725518229574539282952195876, 1780817800198023000883/2714698592128555335, 10496933702144384861481099/35112187013370512767819), (174938507771950701/17172711230303, 86729435597548814201422324152744661099218833956036375079/10504681024077003772117764708845367167814277713615230, 277604481676849251455466208585737287735454384381843/33134345711888048790245068206922835060748495310, 82340278687177090330406983822028763611528890577998444961/9320405532520286199657160314518089053432146844432970, 47474711366082722854469/5208294416327366567, 13942044093755787411229473/1505197086318608937863, 186787121372868012881/18838464219642391, 127082420944101020947575891864919067784249867458646793042/15757021536115505658176647063268050751721416570422845, 10779247166614180940814191677619346705719600396962344678613659/1567255708500597118929079382672262965942376654496818129280, 87606325562060035872680773/11610616460171096633075, 40642356800621482393462328887/8150286778134989496052333), (11216963111399284275/643457312756272, 8596502761386571791813431091096704201464047591642186742999/617208461268993327653509036747543884646831973462332592, 1227634314505855054710474290618211386715335444859401/86661666409810736667914300024633912784741798736, 12249697769596726796078668288933775982446786866175132481959/815280921024324043780338983170398510977024501242461616, 667824625523893343465027/42901229413398923056, 2593213496639813398971932953/164183004965077678535312, 20313091888179867181887/1197474059039422192, 25221192108341625342020400180238342512531638326653180514981/1851625383806979982960527110242631653940495920386997776, 308926722753776264051044157273226017979403837821003657658922413237/27091986182638989002451694574314668661657306199012444865145616, 26596322327063011572365871915/2080219603563690167543216, 3965428369510319715718735895529/485447638183434555842038672), (10691647431737157/3495933855926, 17645125521847695656091045635516391895666847758537/7404822399356379765565149996928165709596207768, 1407752063912113501102008262988863796628519757/581545778634758483119857849440679000203896, 71565552696134120268793666240490884153986714659317/27802107524036379174576825693724962708328379704, 100836743608841475847/38074215624890066, 86243538444895962834815/31715821615533424978, 5513757294744321291/1870324612920410, 17006362158029532159472030854202430653665364362129/7404822399356379765565149996928165709596207768, 4912391129964581169932011481333941393815417851259030773/2591705823195185161553186358678593432913907036656248, 10417082223260338202895/4926060965509775858, 166610642505491726148560067/125317960889153983087546), (11255942350247670/12960745785257, 11114976825146409281945315264563041322033707839227/17752003401085956750310000823571326828764069145, 188595734176234694446879742114256747800822129/297927387783602530004363528129081594843737, 50369077057915367362137471351877164151256021517767/72594107083271828236846144633759145565359662069, 996538616015138037850/1405372547732772281, 739689149083081750385786/985166155960673368981, 6318106119703884858/7711643742227915, 278464682133029269333895621139268668290646711371374/479304091829320832258370022236425824376629866915, 1211280528509313187687374393063740333376003879207468661/2734125307161398833290018070476250753033718419279088, 176092885932332283925602/326723617080537062185, 384269353730309665570875810/1239691669721922014368507), (60719471977627723923/3120724956421612, 2435389122988390321113493166499640310911626225884657232541697/154968887532119294099971048432829244756907650173680134965, 26966303868399084231264220853686725312157660494424166361/1690784872970588555997720238206636241960696636012003, 1161052698940078322822429062088833360696299661626016532235857/69010375328893168201644194574325359029433271527748522915, 68402850631587355380437983/3942414958172378861212, 277301386927460239611435270591/15710523608316929761929820, 131732043408917139992677/6962337377776616372, 7127230957387205713395865438374686896251224117275630924952396/464906662596357882299913145298487734270722950521040404895, 240555343281859860686536376595556411917985628819007248447254112771166/18440772854742133283428769480840824997451972714260705331092984195, 2672151607008303311826292481/186794846361936766950820, 248469532946408815620013056020525/26379355772443279952194866452), (31490768014155929993/2845326924825019, 4721199833600587332648201288317465576429947845016388628798640069/554337782712425847846134975154311822570244414563197610983920, 613849912137528231391665802353498382522199257392195910483/70914979171814253009157038552106653383998256933593232, 217477466951564370789102267410915189326788274996139663314570277/23540437271955026222937321929234194150631292632527440587760, 115343109387045205322105651/12143237879210494062877, 405765130676287578336236765901/41469157357503837224724955, 9900205214077220654855/930421904417781213, 4531230685629311657312408424223279237930005824338687604025802789/554337782712425847846134975154311822570244414563197610983920, 4739594975615933747444664011869365803125482631317780852317256614870521/711178145473938021204901346196100346332389794329935114538205852080, 32247276231673393796277422005/4293397452325387949483619, 173497301316084917695685349009407/37337888151595818002168049229), (28301942522978080818/1813660456227445, 2188279853140956762326397910850053699250601949833952451966854/174920470120106209632757097089294502885550993894349244985, 997672449870302638227398187068739077959481057584394988/78560402070853374056344479650698406423481733540445, 13570163510918424678419992247370539202671317101351023420597102/1011573227588480701625411866806157696676316397614423835405, 74983995839214615577725474/5422995297937927427935, 259011479362553056167939955266/18378531064711636053271715, 18049160885887329491306/1191574919741431365, 2129417287418241260481292417381476807893016728661702049768633/174920470120106209632757097089294502885550993894349244985, 9013939530783458615634743019229733496501997429992282802819266084198/875243015441506707731453911334439493184184585807889050938965795, 5650979187260881444585317182/499347343741442934973725, 73149725450776848064943416546038/9910935790923416302933914895), (9724480510207197717/1339350472584301, 30178884920632999605382351309232914795143353032942062715766/5449703287932003556332083107322104300475865847572348581, 260787850283486645354516289872373459660465744518886204/46335892188210517173544447529797763006435222701337, 6791115168575532155340786303423064509893045605022120257952/1127478740242303203455785055163154105994092148065205599, 6476682342555734339778109/1046591228235406734517, 2334933855746180485230365325/365260338654156950346433, 15717729860591091849181/2256805546304547185, 346343620148165077696155569786722872720077534339499084753995/65396439455184042675984997287865251605710390170868182972, 81199044009501134476517420413117790272202358009610619771240105781/18968398638848569488283948718086368994879122438936545926616986, 4058060551360534025756318341/834691718050686820927049, 16302451115508715643571462784487/5478171384763259827277935151)]
bernoulli_conditional_times = {(0, 0, 1, 0, 0, 0): (15/4*r^5*p^4 + 15/4*r^4*p^4 + 7/2*r^4*p^3 + 13/4*r^3*p^3 + 17/8*r^3*p^2 + 2*r^2*p^2 + 33/32*r^2*p + 33/32*r*p + 25/64*r + 29/64)/(1/4*r^5*p^5 + 1/8*r^4*p^4 + 1/16*r^3*p^3 + 1/32*r^2*p^2 + 1/64*r*p + 1/64), (0, 1, 0, 0, 0, 0): (2688*r^18*p^17 + 2304*r^17*p^17 + 25072*r^17*p^16 + 20288*r^16*p^16 + 107768*r^16*p^15 + 83524*r^15*p^15 + 286132*r^15*p^14 + 216002*r^14*p^14 + 532384*r^14*p^13 + 398111*r^13*p^13 + 1496925/2*r^13*p^12 + 562641*r^12*p^12 + 3346741/4*r^12*p^11 + 2557229/4*r^11*p^11 + 6152403/8*r^11*p^10 + 4809471/8*r^10*p^10 + 9475773/16*r^10*p^9 + 7591779/16*r^9*p^9 + 6165087/16*r^9*p^8 + 2525103/8*r^8*p^8 + 848943/4*r^8*p^7 + 5654883/32*r^7*p^7 + 12618283/128*r^7*p^6 + 10582913/128*r^6*p^6 + 9776705/256*r^6*p^5 + 4081181/128*r^5*p^5 + 6212551/512*r^5*p^4 + 2550499/256*r^4*p^4 + 3160859/1024*r^4*p^3 + 634675/256*r^3*p^3 + 306301/512*r^3*p^2 + 970559/2048*r^2*p^2 + 39987/512*r^2*p + 63315/1024*r*p + 5103/1024*r + 8019/2048)/(256*r^18*p^18 + 2240*r^17*p^17 + 8900*r^16*p^16 + 21564*r^15*p^15 + 36309*r^14*p^14 + 92241/2*r^13*p^13 + 187543/4*r^12*p^12 + 159227/4*r^11*p^11 + 232759/8*r^10*p^10 + 599605/32*r^9*p^9 + 173093/16*r^8*p^8 + 722389/128*r^7*p^7 + 678483/256*r^6*p^6 + 70601/64*r^5*p^5 + 50711/128*r^4*p^4 + 242245/2048*r^3*p^3 + 56607/2048*r^2*p^2 + 9099/2048*r*p + 729/2048), (1, 0, 0, 0, 0, 0): (13/4*r^8*p^7 + 11/4*r^7*p^7 + 75/8*r^7*p^6 + 51/8*r^6*p^6 + 185/16*r^6*p^5 + 139/16*r^5*p^5 + 305/32*r^5*p^4 + 253/32*r^4*p^4 + 89/16*r^4*p^3 + 155/32*r^3*p^3 + 311/128*r^3*p^2 + 283/128*r^2*p^2 + 169/256*r^2*p + 131/256*r*p + 59/512*r + 43/512)/(1/4*r^8*p^8 + 5/8*r^7*p^7 + 9/16*r^6*p^6 + 3/8*r^5*p^5 + 3/16*r^4*p^4 + 13/128*r^3*p^3 + 15/256*r^2*p^2 + 11/512*r*p + 3/512)}
bernoulli_conditional_mean_time_from1 = (77/2147483648*r^20*p^19 + 35/1073741824*r^19*p^19 + 5979/17179869184*r^19*p^18 + 1311/4294967296*r^18*p^18 + 13503/8589934592*r^18*p^17 + 92235/68719476736*r^17*p^17 + 609753/137438953472*r^17*p^16 + 511791/137438953472*r^16*p^16 + 2440913/274877906944*r^16*p^15 + 508231/68719476736*r^15*p^15 + 7460275/549755813888*r^15*p^14 + 3107503/274877906944*r^14*p^14 + 18270995/1099511627776*r^14*p^13 + 15319063/1099511627776*r^13*p^13 + 37030271/2199023255552*r^13*p^12 + 15688841/1099511627776*r^12*p^12 + 63404007/4398046511104*r^12*p^11 + 54427845/4398046511104*r^11*p^11 + 11610367/1099511627776*r^11*p^10 + 40424255/4398046511104*r^10*p^10 + 29310531/4398046511104*r^10*p^9 + 12929859/2199023255552*r^9*p^9 + 31959651/8796093022208*r^9*p^8 + 28538415/8796093022208*r^8*p^8 + 7512555/4398046511104*r^8*p^7 + 108378741/70368744177664*r^7*p^7 + 48433159/70368744177664*r^7*p^6 + 43967045/70368744177664*r^6*p^6 + 33080181/140737488355328*r^6*p^5 + 60295443/281474976710656*r^5*p^5 + 37587931/562949953421312*r^5*p^4 + 8578055/140737488355328*r^4*p^4 + 17210235/1125899906842624*r^4*p^3 + 15714501/1125899906842624*r^3*p^3 + 3000883/1125899906842624*r^3*p^2 + 5483245/2251799813685248*r^2*p^2 + 11115/35184372088832*r^2*p + 40779/140737488355328*r*p + 2673/140737488355328*r + 39609/2251799813685248)/(3/1073741824*r^20*p^20 + 111/4294967296*r^19*p^19 + 7563/68719476736*r^18*p^18 + 39861/137438953472*r^17*p^17 + 36987/68719476736*r^16*p^16 + 104499/137438953472*r^15*p^15 + 948279/1099511627776*r^14*p^14 + 897357/1099511627776*r^13*p^13 + 2914545/4398046511104*r^12*p^12 + 4150731/8796093022208*r^11*p^11 + 5272485/17592186044416*r^10*p^10 + 3021549/17592186044416*r^9*p^9 + 1569933/17592186044416*r^8*p^8 + 368565/8796093022208*r^7*p^7 + 4946937/281474976710656*r^6*p^6 + 3638223/562949953421312*r^5*p^5 + 2283441/1125899906842624*r^4*p^4 + 1175565/2251799813685248*r^3*p^3 + 233163/2251799813685248*r^2*p^2 + 31671/2251799813685248*r*p + 2187/2251799813685248)
