G = [(0, 3), (0, 4), (0, 5), (1, 3), (1, 4), (1, 5), (2, 3), (2, 4), (2, 5)]
moran_P = {(1, 0, 0, 0, 0, 0): {(1, 0, 0, 1, 0, 0): r, (1, 0, 0, 0, 0, 0): 4, (0, 0, 0, 0, 0, 0): 1}, (0, 0, 0, 0, 0, 0): {(0, 0, 0, 0, 0, 0): 6}, (1, 0, 0, 1, 0, 0): {(1, 0, 0, 1, 0, 0): 2/3*r + 8/3, (1, 1, 0, 1, 0, 0): 4/3*r, (1, 0, 0, 0, 0, 0): 4/3}, (1, 1, 0, 1, 0, 0): {(1, 1, 0, 1, 0, 0): 4/3*r + 4/3, (1, 1, 0, 1, 1, 0): 4/3*r, (1, 1, 0, 0, 0, 0): 1/3, (1, 1, 1, 1, 0, 0): 1/3*r, (1, 0, 0, 1, 0, 0): 4/3}, (1, 1, 1, 1, 0, 0): {(1, 1, 1, 1, 0, 0): 2*r, (1, 1, 1, 1, 1, 0): 2*r, (1, 1, 0, 1, 0, 0): 2}, (1, 1, 1, 1, 1, 0): {(1, 1, 1, 1, 1, 0): 4*r, (1, 1, 1, 1, 1, 1): r, (1, 1, 0, 1, 1, 0): 1}, (1, 1, 0, 1, 1, 0): {(1, 1, 0, 1, 1, 0): 8/3*r + 2/3, (1, 1, 1, 1, 1, 0): 4/3*r, (1, 1, 0, 1, 0, 0): 4/3}, (1, 1, 1, 1, 1, 1): {(1, 1, 1, 1, 1, 1): 6*r}, (1, 1, 0, 0, 0, 0): {(1, 1, 0, 1, 0, 0): 2*r, (1, 1, 0, 0, 0, 0): 2, (1, 0, 0, 0, 0, 0): 2}}
moran_W = {(1, 0, 0, 0, 0, 0): r + 5, (0, 0, 0, 0, 0, 0): 6, (1, 0, 0, 1, 0, 0): 2*r + 4, (1, 1, 0, 1, 0, 0): 3*r + 3, (1, 1, 1, 1, 0, 0): 4*r + 2, (1, 1, 1, 1, 1, 0): 5*r + 1, (1, 1, 0, 1, 1, 0): 4*r + 2, (1, 1, 1, 1, 1, 1): 6*r, (1, 1, 0, 0, 0, 0): 2*r + 4}
moran_Q = [(r + 1, -r, 0, 0, 0, 0, 0), (-4/3, 4/3*r + 4/3, 0, -4/3*r, 0, 0, 0), (-2, 0, 2*r + 2, -2*r, 0, 0, 0), (0, -4/3, -1/3, 5/3*r + 5/3, -4/3*r, -1/3*r, 0), (0, 0, 0, -4/3, 4/3*r + 4/3, 0, -4/3*r), (0, 0, 0, -2, 0, 2*r + 2, -2*r), (0, 0, 0, 0, -1, 0, r + 1)]
moran_b = (0, 0, 0, 0, 0, 0, r)
moran_used_states = {(0, 0, 0, 0, 0, 0): 0, (1, 0, 0, 0, 0, 0): 1, (1, 0, 0, 1, 0, 0): 2, (1, 1, 0, 0, 0, 0): 3, (1, 1, 0, 1, 0, 0): 4, (1, 1, 0, 1, 1, 0): 5, (1, 1, 1, 1, 0, 0): 6, (1, 1, 1, 1, 1, 0): 7, (1, 1, 1, 1, 1, 1): 8}
moran_w = (r + 5, 2*r + 4, 2*r + 4, 3*r + 3, 4*r + 2, 4*r + 2, 5*r + 1)
moran_det = 320/27*r^7 + 320/9*r^6 + 1280/27*r^5 + 1280/27*r^4 + 1280/27*r^3 + 1280/27*r^2 + 320/9*r + 320/27
moran_Phi_used_values = [{r: 1}, {r: 2}, {r: 3}, {r: 4}, {r: 5}, {r: 1/2}, {r: 1/3}, {r: 1/4}]
moran_Phi_computed = [(1/6, 1/3, 1/3, 1/2, 2/3, 2/3, 5/6), (32/63, 16/21, 16/21, 8/9, 20/21, 20/21, 62/63), (243/364, 81/91, 81/91, 27/28, 90/91, 90/91, 363/364), (1024/1365, 256/273, 256/273, 64/65, 272/273, 272/273, 1364/1365), (3125/3906, 625/651, 625/651, 125/126, 650/651, 650/651, 3905/3906), (1/63, 1/21, 1/21, 1/9, 5/21, 5/21, 31/63), (1/364, 1/91, 1/91, 1/28, 10/91, 10/91, 121/364), (1/1365, 1/273, 1/273, 1/65, 17/273, 17/273, 341/1365)]
moran_PhiNum = {(1, 0, 0, 0, 0, 0): 320/27*r^7 + 640/27*r^6 + 320/27*r^5}
moran_mean_phi = 320/27*r^5/(320/27*r^5 + 320/27*r^4 + 320/27*r^3 + 320/27*r^2 + 320/27*r + 320/27)
moran_UT_used_values = [{r: 1}, {r: 2}, {r: 3}, {r: 4}, {r: 5}, {r: 1/2}, {r: 1/3}, {r: 1/4}]
moran_UT_computed = [(243/20, 183/10, 351/20, 399/20, 183/10, 351/20, 243/20), (13367/945, 5581/315, 5371/315, 2228/135, 8461/630, 3968/315, 15391/1890), (101287/7280, 28909/1820, 55543/3640, 7863/560, 20463/1820, 37741/3640, 49583/7280), (154723/11375, 33562/2275, 32197/2275, 20784/1625, 46681/4550, 21293/2275, 142231/22750), (313165/23436, 54821/3906, 105085/7812, 45623/3780, 189893/19530, 343981/39060, 697673/117180), (15391/1890, 8461/630, 3968/315, 2228/135, 5581/315, 5371/315, 13367/945), (49583/7280, 20463/1820, 37741/3640, 7863/560, 28909/1820, 55543/3640, 101287/7280), (142231/22750, 46681/4550, 21293/2275, 20784/1625, 33562/2275, 32197/2275, 154723/11375)]
moran_unconditional_times_num = {(1, 0, 0, 0, 0, 0): 3872/27*r^7 + 13952/27*r^6 + 21152/27*r^5 + 736*r^4 + 576*r^3 + 416*r^2 + 6080/27*r + 1600/27}
moran_unconditional_mean_time_from1 = (3872/27*r^6 + 1120/3*r^5 + 11072/27*r^4 + 8800/27*r^3 + 6752/27*r^2 + 4480/27*r + 1600/27)/(320/27*r^6 + 640/27*r^5 + 640/27*r^4 + 640/27*r^3 + 640/27*r^2 + 640/27*r + 320/27)
moran_CT_used_values = [{r: 1}, {r: 2}, {r: 3}, {r: 4}, {r: 5}, {r: 6}, {r: 7}, {r: 8}, {r: 1/2}, {r: 1/3}, {r: 1/4}, {r: 1/5}, {r: 1/6}, {r: 1/7}, {r: 1/8}]
moran_CT_computed = [(539/20, 479/20, 116/5, 399/20, 619/40, 589/40, 919/100), (67/3, 20, 58/3, 352/21, 79/6, 37/3, 736/93), (68903/3640, 61623/3640, 14837/910, 51543/3640, 407749/36400, 375899/36400, 2985007/440440), (5569/325, 4984/325, 4789/325, 29233/2275, 113257/11050, 51656/5525, 691979/110825), (209239/13020, 62513/4340, 44986/3255, 157579/13020, 658079/67704, 596017/67704, 12103199/2033724), (717211/46655, 643896/46655, 617236/46655, 542526/46655, 32413447/3452470, 14603791/1726235, 418526666/72548525), (194533/13072, 174925/13072, 41893/3268, 147749/13072, 239555/26144, 215045/26144, 206688149/36614672), (906143/62415, 271996/20805, 781313/62415, 690683/62415, 73024843/8113950, 32680834/4056975, 1623071507/292164615), (671/30, 187/10, 268/15, 1516/105, 781/75, 731/75, 2647/465), (13817/728, 10905/728, 2567/182, 7881/728, 10799/1456, 9889/1456, 338161/88088), (11177/650, 8447/650, 3931/325, 20432/2275, 1942/325, 1747/325, 331541/110825), (210107/13020, 51229/4340, 35438/3255, 103007/13020, 349939/67704, 310445/67704, 5139235/2033724), (1441087/93310, 1027857/93310, 470606/46655, 336996/46655, 8045431/1726235, 7059011/1726235, 162277411/72548525), (977567/65360, 683447/65360, 155543/16340, 440927/65360, 14096209/3268000, 12257959/3268000, 373283503/183073360), (364399/24966, 83555/8322, 113543/12483, 79856/12483, 659116/162279, 568961/162279, 110767751/58432923)]
moran_conditional_times_wodet = {(1, 0, 0, 0, 0, 0): 3872/27*r^7 + 17504/27*r^6 + 11872/9*r^5 + 15488/9*r^4 + 15488/9*r^3 + 11872/9*r^2 + 17536/27*r + 3904/27}
moran_conditional_mean_time_from1 = (3872/27*r^5 + 9760/27*r^4 + 12224/27*r^3 + 12256/27*r^2 + 9728/27*r + 3904/27)/(320/27*r^5 + 320/27*r^4 + 320/27*r^3 + 320/27*r^2 + 320/27*r + 320/27)
bernoulli_P = {(1, 0, 0, 0, 0, 0): {(1, 1, 1, 1, 0, 0): r*p, (1, 0, 0, 0, 0, 0): -r*p + r + 4, (0, 0, 0, 0, 0, 0): 1}, (0, 0, 0, 0, 0, 0): {(0, 0, 0, 0, 0, 0): 6}, (1, 1, 1, 1, 0, 0): {(1, 1, 1, 1, 1, 1): 3*r*p, (1, 1, 1, 1, 0, 0): -3*r*p + 4*r, (1, 1, 0, 1, 0, 0): 2}, (1, 1, 0, 1, 0, 0): {(1, 1, 1, 1, 1, 0): 2*r*p, (1, 1, 0, 1, 0, 0): -3*r*p + 3*r + 4/3, (1, 1, 0, 0, 0, 0): 1/3, (1, 1, 1, 1, 0, 0): r*p, (1, 0, 0, 1, 0, 0): 4/3}, (1, 0, 0, 1, 0, 0): {(1, 1, 1, 1, 0, 0): 2*r*p, (1, 0, 0, 1, 0, 0): -2*r*p + 2*r + 8/3, (1, 0, 0, 0, 0, 0): 4/3}, (1, 1, 0, 0, 0, 0): {(1, 1, 1, 1, 1, 0): 2*r*p, (1, 1, 0, 0, 0, 0): -2*r*p + 2*r + 2, (1, 0, 0, 0, 0, 0): 2}, (1, 1, 1, 1, 1, 0): {(1, 1, 1, 1, 1, 1): 3*r*p, (1, 1, 1, 1, 1, 0): -3*r*p + 5*r, (1, 1, 0, 1, 1, 0): 1}, (1, 1, 0, 1, 1, 0): {(1, 1, 1, 1, 1, 0): 4*r*p, (1, 1, 0, 1, 1, 0): -4*r*p + 4*r + 2/3, (1, 1, 0, 1, 0, 0): 4/3}, (1, 1, 1, 1, 1, 1): {(1, 1, 1, 1, 1, 1): 6*r}}
bernoulli_W = {(1, 0, 0, 0, 0, 0): r + 5, (0, 0, 0, 0, 0, 0): 6, (1, 1, 1, 1, 0, 0): 4*r + 2, (1, 1, 0, 1, 0, 0): 3*r + 3, (1, 0, 0, 1, 0, 0): 2*r + 4, (1, 1, 0, 0, 0, 0): 2*r + 4, (1, 1, 1, 1, 1, 0): 5*r + 1, (1, 1, 0, 1, 1, 0): 4*r + 2, (1, 1, 1, 1, 1, 1): 6*r}
bernoulli_Q = [(r*p + 1, 0, 0, 0, 0, -r*p, 0), (-4/3, 2*r*p + 4/3, 0, 0, 0, -2*r*p, 0), (-2, 0, 2*r*p + 2, 0, 0, 0, -2*r*p), (0, -4/3, -1/3, 3*r*p + 5/3, 0, -r*p, -2*r*p), (0, 0, 0, -4/3, 4*r*p + 4/3, 0, -4*r*p), (0, 0, 0, -2, 0, 3*r*p + 2, 0), (0, 0, 0, 0, -1, 0, 3*r*p + 1)]
bernoulli_b = (0, 0, 0, 0, 0, 3*r*p, 3*r*p)
bernoulli_used_states = {(0, 0, 0, 0, 0, 0): 0, (1, 0, 0, 0, 0, 0): 1, (1, 0, 0, 1, 0, 0): 2, (1, 1, 0, 0, 0, 0): 3, (1, 1, 0, 1, 0, 0): 4, (1, 1, 0, 1, 1, 0): 5, (1, 1, 1, 1, 0, 0): 6, (1, 1, 1, 1, 1, 0): 7, (1, 1, 1, 1, 1, 1): 8}
bernoulli_w = (r + 5, 2*r + 4, 2*r + 4, 3*r + 3, 4*r + 2, 4*r + 2, 5*r + 1)
bernoulli_det = 432*r^7*p^7 + 1728*r^6*p^6 + 2736*r^5*p^5 + 2144*r^4*p^4 + 976*r^3*p^3 + 2864/9*r^2*p^2 + 1792/27*r*p + 320/27
bernoulli_Phi_used_values = [{r: 5981, p: 1/2767}, {r: 769, p: 1/2237}, {r: 2999, p: 1/3767}, {r: 2521, p: 1/5839}, {r: 7237, p: 1/1811}, {r: 1901, p: 1/5881}, {r: 6257, p: 1/1499}, {r: 2377, p: 1/1901}]
bernoulli_Phi_computed = [(654654116414424643727194280343/961673399185806494955537843922, 443063392073467358017693483851/480836699592903247477768921961, 432159804966185111241621967959/480836699592903247477768921961, 944044193134004381875279526613/961673399185806494955537843922, 479504835951491435922735697326/480836699592903247477768921961, 478758920781924994426140742722/480836699592903247477768921961, 961317506699492010882840892443/961673399185806494955537843922), (13014613997377389162269493/74786306423163539340264608, 6473719659807393252372069/18696576605790884835066152, 12910649988070814915070873/37393153211581769670132304, 38543368410233925713284539/74786306423163539340264608, 1593701335429542053813031/2337072075723860604383269, 25436885355082205345762091/37393153211581769670132304, 63075599760921352033041915/74786306423163539340264608), (7569649161023789554667658101/18301665448570432946235737956, 3186112084108857765493773218/4575416362142608236558934489, 6097830031486180337313688041/9150832724285216473117868978, 15616220993323726720996392883/18301665448570432946235737956, 4325235178457646697239906916/4575416362142608236558934489, 8538887333025501855098595317/9150832724285216473117868978, 18006324640378251774623460655/18301665448570432946235737956), (1328270209997177378354248435/5696142652638665915179787054, 1268763483682663221078568265/2848071326319332957589893527, 1241961332949008675430705123/2848071326319332957589893527, 3568384541421165183674581841/5696142652638665915179787054, 2233445326427395259306397646/2848071326319332957589893527, 2202367900748989068433462300/2848071326319332957589893527, 5160580615126499936926193195/5696142652638665915179787054), (1505614186035123306281542598811/1883462268250030555781391704366, 914256622736284759820351707161/941731134125015277890695852183, 903897808387632219099967907211/941731134125015277890695852183, 1875905321291294960081231536233/1883462268250030555781391704366, 941417967984811839133121059422/941731134125015277890695852183, 941190904742696951446414082772/941731134125015277890695852183, 1883414045830176085278035871555/1883462268250030555781391704366), (8822134989214709726902521225/55311008824919662612356224416, 4433545880351417536388401305/13827752206229915653089056104, 8892907865129249527916157309/27655504412459831306178112208, 26806903981020841493465605671/55311008824919662612356224416, 1125556070701731278241516483/1728469025778739456636132013, 18057299970033895606195533975/27655504412459831306178112208, 45516171563019427537387346151/55311008824919662612356224416), (13570749319939630352031969581/16830222729969422690853044374, 8187084883034000891783538817/8415111364984711345426522187, 15042838143825152268168882927/15628063963543035355792112633, 2395701423221085464365303153/2404317532852774670121863482, 109365324876036145011322536146/109396447744801247490544788431, 1201565466397084100211876482/1202158766426387335060931741, 218788292314439309128464598453/218792895489602494981089576862), (291337725638024534490941283/535795524255616496245812248, 110827183840532702730067209/133948881063904124061453062, 213096883881660186038269023/267897762127808248122906124, 502837914407784356892642429/535795524255616496245812248, 65934547185700810970457324/66974440531952062030726531, 262167183483270710675693481/267897762127808248122906124, 534044561234160669615544965/535795524255616496245812248)]
bernoulli_PhiNum = {(1, 0, 0, 0, 0, 0): 432*r^7*p^7 + 1296*r^6*p^6 + 1440*r^5*p^5 + 704*r^4*p^4 + 464/3*r^3*p^3 + 160/9*r^2*p^2}
bernoulli_mean_phi = (432*r^7*p^7 + 1296*r^6*p^6 + 1440*r^5*p^5 + 704*r^4*p^4 + 464/3*r^3*p^3 + 160/9*r^2*p^2)/(432*r^7*p^7 + 1728*r^6*p^6 + 2736*r^5*p^5 + 2144*r^4*p^4 + 976*r^3*p^3 + 2864/9*r^2*p^2 + 1792/27*r*p + 320/27)
bernoulli_UT_used_values = [{r: 2731, p: 1/2273}, {r: 2917, p: 1/503}, {r: 7247, p: 1/6551}, {r: 2383, p: 1/1877}, {r: 4621, p: 1/1483}, {r: 107, p: 1/2677}, {r: 4567, p: 1/8387}, {r: 3203, p: 1/3659}, {r: 3761, p: 1/139}, {r: 8599, p: 1/179}, {r: 1381, p: 1/967}, {r: 1187, p: 1/4561}, {r: 31, p: 1/5197}, {r: 7717, p: 1/8419}]
bernoulli_UT_computed = [(37781078845167734897349975007587/10750153388586589461120066902, 28993736720540083337065887353394/5375076694293294730560033451, 28135764719536285691727323363913/5375076694293294730560033451, 33330946268884202501118231418956/5375076694293294730560033451, 35282416734596363652931974514029/5375076694293294730560033451, 22373139624431220029673156264966/5375076694293294730560033451, 47208061692212975507287235939685/10750153388586589461120066902), (2643621666594431885207901937659/2496440227451213110137229202, 1525660567333360560469541457060/1248220113725606555068614601, 1653486231429585752159291718249/1248220113725606555068614601, 1647390252177685933325143523499/1248220113725606555068614601, 1706934097432462618736775491727/1248220113725606555068614601, 920809587317946067771180975572/1248220113725606555068614601, 2164788579240497599951739095557/2496440227451213110137229202), (38881835071075701063425216015264585/3956023242073815227836199567772, 1169350449410990826476790712557617/76077370039881062073773068611, 9774344202165407930000078941340329/659337207012302537972699927962, 70561410546390933333094623451778677/3956023242073815227836199567772, 18782533027684512506681550586972453/989005810518453806959049891943, 24047840045377365554971207483817069/1978011621036907613918099783886, 50589083384852540887764890410047487/3956023242073815227836199567772), (10950357654748487070165470227635/3702958937825667498124175318, 8300039410174942502846467625886/1851479468912833749062087659, 8088745375300212027833623108629/1851479468912833749062087659, 9486779000010469590174240282036/1851479468912833749062087659, 10008251670848418296051231773581/1851479468912833749062087659, 6305253804705638545548230617302/1851479468912833749062087659, 13338420757604830452917239803525/3702958937825667498124175318), (10961149786311573401732925532401/3798398413613863409194752026, 6927941289723428445158674523832/1899199206806931704597376013, 1034918778882896278096479152607/271314172400990243513910859, 1074849667955429727572307021234/271314172400990243513910859, 7781981698801887881047939492347/1899199206806931704597376013, 631410723585226872569346258234/271314172400990243513910859, 9985535634199461656432332986975/3798398413613863409194752026), (3395515833441799841238886419/25073626544620980139677898, 4047122566415308841366953098/12536813272310490069838949, 3571977069293958949975542695/12536813272310490069838949, 6890943936360723015078907165/12536813272310490069838949, 11505834172818667471794831139/12536813272310490069838949, 9044117173773504713132120096/12536813272310490069838949, 32548259115611921500656914869/25073626544620980139677898), (28907965966835862976112214719506059/3303421353825574663211605492328, 13191749322205326141810303334840539/825855338456393665802901373082, 24628127798802899979835483560473955/1651710676912787331605802746164, 68401799856966323183821653832469145/3303421353825574663211605492328, 9962448459944034058693262742105531/412927669228196832901450686541, 27129723765773737247923276532599641/1651710676912787331605802746164, 58906644969214430087803636700314869/3303421353825574663211605492328), (112878290152459032744146082432617/22628735942665407308403734508, 46508693529728967554270975967665/5657183985666351827100933627, 29446208526673071808195259951713/3771455990444234551400622418, 222560904164189036629309288291933/22628735942665407308403734508, 60521379564782033139718878985201/5657183985666351827100933627, 79449437287258735528404804391013/11314367971332703654201867254, 166708803516323548846968415292191/22628735942665407308403734508), (2845095426459899861897615546571/8976067165982818245027590794, 1473372716811350057961470006952/4488033582991409122513795397, 1662750221174231915955794773529/4488033582991409122513795397, 1603892052996159887273484432793/4488033582991409122513795397, 1670557601267897863194014005075/4488033582991409122513795397, 850456577977654834273215576752/4488033582991409122513795397, 2094918558161023105786236137893/8976067165982818245027590794), (1134601425773562960345308170787787/2752421958170936214776467558424, 289431725339068334537325184529067/688105489542734053694116889606, 93831831002139816987377004349533/196601568440781158198319111316, 180478040215990500123357487067847/393203136881562316396638222632, 164614379953648681790240695519581/344052744771367026847058444803, 47517836118069759494911709110407/196601568440781158198319111316, 824574563828659938679100535971733/2752421958170936214776467558424), (34243754449073622452331737961/21643540504082173800555574, 25279913091227246603459610684/10821770252041086900277787, 24867612835619928402111582267/10821770252041086900277787, 28570529590882339222676287029/10821770252041086900277787, 29956459915236194038365598893/10821770252041086900277787, 18608370949798219802966946420/10821770252041086900277787, 39623006771714084597267484951/21643540504082173800555574), (13646777304206479056639157489635/5650874952848147761086297166, 14175627518598461057711235313386/2825437476424073880543148583, 13364606428298545718139649129181/2825437476424073880543148583, 21237349562990079466119903500818/2825437476424073880543148583, 28798375644935284712905070873233/2825437476424073880543148583, 20100883015134744105767006070962/2825437476424073880543148583, 51180880767114736894478641992421/5650874952848147761086297166), (26127318844687429373525433201/706084358299436009518724554, 2377751711426672080192974978/27157090703824461904566329, 25384331387858444781336091827/353042179149718004759362277, 50840120822479865686131459114/353042179149718004759362277, 85144050363923246525837073123/353042179149718004759362277, 72433679952706433417963718030/353042179149718004759362277, 275507078157927519708636131031/706084358299436009518724554), (8560142281337555281287975463174845/730997615823435553255903504114, 6982665918975237869759302483256592/365498807911717776627951752057, 86447445006722087333833315585779177/4751484502852331096163372776741, 8300203558774952524678998896133486/365498807911717776627951752057, 116809548495983056741473369015680739/4751484502852331096163372776741, 5870363560489855301705756304899502/365498807911717776627951752057, 160086514048432049166640615037838231/9502969005704662192326745553482)]
bernoulli_unconditional_times_num = {(1, 0, 0, 0, 0, 0): 1008*r^7*p^6 + 2448*r^6*p^6 + 3376*r^6*p^5 + 7568*r^5*p^5 + 12896/3*r^5*p^4 + 26848/3*r^4*p^4 + 22976/9*r^4*p^3 + 48016/9*r^3*p^3 + 20464/27*r^3*p^2 + 50384/27*r^2*p^2 + 128*r^2*p + 3584/9*r*p + 320/27*r + 1600/27}
bernoulli_unconditional_mean_time_from1 = (1008*r^7*p^6 + 2448*r^6*p^6 + 3376*r^6*p^5 + 7568*r^5*p^5 + 12896/3*r^5*p^4 + 26848/3*r^4*p^4 + 22976/9*r^4*p^3 + 48016/9*r^3*p^3 + 20464/27*r^3*p^2 + 50384/27*r^2*p^2 + 128*r^2*p + 3584/9*r*p + 320/27*r + 1600/27)/(432*r^7*p^7 + 1728*r^6*p^6 + 2736*r^5*p^5 + 2144*r^4*p^4 + 976*r^3*p^3 + 2864/9*r^2*p^2 + 1792/27*r*p + 320/27)
bernoulli_CT_used_values = [{r: 6011, p: 1/5101}, {r: 557, p: 1/4639}, {r: 1009, p: 1/3761}, {r: 3109, p: 1/9907}, {r: 6691, p: 1/4937}, {r: 1093, p: 1/2179}, {r: 1627, p: 1/3463}, {r: 4447, p: 1/2141}, {r: 269, p: 1/5233}, {r: 2011, p: 1/8123}, {r: 1531, p: 1/5167}, {r: 4789, p: 1/9391}, {r: 4663, p: 1/241}, {r: 8291, p: 1/6361}, {r: 2663, p: 1/9587}, {r: 2011, p: 1/1049}, {r: 4457, p: 1/6823}, {r: 3203, p: 1/3361}, {r: 3931, p: 1/4337}, {r: 7841, p: 1/1627}, {r: 4759, p: 1/4099}, {r: 8941, p: 1/5879}, {r: 3499, p: 1/7691}, {r: 5179, p: 1/7019}, {r: 7457, p: 1/1123}, {r: 8627, p: 1/401}, {r: 5657, p: 1/6659}, {r: 9511, p: 1/2381}]
bernoulli_CT_computed = [(14324331536570379227804372322294966963929119313318196/1198375387262694674765460231796460952822146158283, 302533680592214487572435152927545238758011385925826397/23098489291058615525915799350077172376470072356705, 3817404855476718519292878305561799675756072235741502516/288328703373617224497615868453355316974047275016551, 742979407470628752992345360053194424339138184371959800/52863145241717505236382455908748393553044221380433, 2660174109382538884515404803164666754547180174608347137/181214608720643750744209039226517617766486318921691, 15299586040775148584364356448587611127997529526040983828/1664543412907882903249224261965284263469961013855087, 43403354104980316525465860575660502022142775349307948726958/4421120427386492398041965951729400685318852185112314949), (15137842304255224092405382395639902123360992974003/4755917314463933911972478242375372472207253377, 19328144792151981531038663953598408916500158123953/5400522419465712880404952231934697775774297309, 323804403302481424599341398343962658741177406353495/77908625167513389287428895885529191568766784973, 90909349735126971459640053621529122050000160182873/20258782943536761794714507763921495253254065587, 596562230424222404083282919016221043494894449185566/110545974831542770629586305140938071614170274701, 33128495487929780965712251698719867551993844741591051/12355873182977300303304498473691217682794444273446, 2047992053890625387868564614978104002074149012424783973/522811327257422679045636840679487771101221600032677), (11313034635187738077443905352273873923780107273687/1919209541496161097966870490410697946814326846, 6406700636191921801556669894477486355950514105951/992989447102668240847775062722683609224817132, 116389147440575827426058112425899516947996067891269/16913528431835548122820449376727618235352374274, 1162815288168201396704836079820259425424551787988325/157203982635159139120036023909708785841246834274, 230890181607548133006795170067583542675505337298369/27660553521484679624830846269660622088402934476, 7773995677513418312250280169518276458128477810321951/1525771585489448072883662039876504867717389842570, 1881480258074431318494218487379470156505172620316076681/303611506579956840038786263301078559446567870026730), (59281825598436277334889945760374415327647790256374195609/3432446821319417755296677728727661313008347918235213, 3443175994878654817793213025188657793155825720196638729/182452905741868093166142335602729740703816990677957, 23081766735614077334637299881508832148186144389246681347/1162218681980122496859427110706085193987085186793631, 225554248909150177808533234270593743224607882673599332667/10558082537796900886174987107193389563398436033414799, 85219169303206275376746002291646876498172898308603368374/3572801579095331464052777599674500577746612919162393, 332859945718853831455879209004024502394576763688469375690985/22338363913146770751470778658559619825058328251874766204, 1000366409176758328592252374593591460603588705870802670327827/56759379529108174813009633379197488681641701921879151385), (490534277769089486624957362901519510964083751144435082164/42392778792822785672247698809771134099478894928189801, 401239604370449979372321558563307868144596569392545044637/31679567122068358117982811355523698868408795191436857, 130775784063022887658849664232646206734506015635583934876/10171222158622912981524195266550475002576175033531171, 964291360366075217876424214000683282324261472009978070856/71060655484083125131251843879684103558640943362772091, 261454740842084163316763969762899556697487129159713014991/18510840584894345150602457539309883767101481045769641, 119514046023985010907178266858756545478261373027204544697090/13692867550081759772136006715556076314131683061805305723, 360434630778322154334171136144552253114671664523954035607018/38487129127895176925468705102527188533123636575302283907), (2336877885490161348260585209864803360916365209545/500434993091589259561711587052016200825301413, 124667516430778181841086253984996951748686176297/24441829569616707321791072668639785636747077, 781140564065038770801244378766949293110535955987/150121174019284014195375976822069838520832871, 7063275699376033076522447721702934162245629441963/1259438059029945706766148650811131045087507639, 2315988145564509699591739764138520765136808585974/380840447317070538903416672612268681383916113, 3224476351041235390629169121384515825881689336184697/818711648697840028642960156417098504550193111668, 8094155410346489044768786126193285528549883090116099/1856731038400010770098651628784531768242659144545), (161261257099112719662274638263191678804114287795462/22163566864130929320714211504592483295047877785, 82762464609007092274930500300583692961108199802159/10416332051246085102112573866264393140020383995, 54980265787479644904748263411935807147391571321592/6759857051643032006833649819502421199507919727, 503098254251636323011049497143272435568085614203320/57394196006318231072330783675133833950633096327, 84026662267578567751882154820330923099718249343425/8806281574933461199015468555377951047424880388, 69555982952809155683716033959290669304291641802315102/11281255533842643024243533655837573997179369792565, 35673850204807464323506794922926146254658881146360984/5187744092267711570042654041888006951288842707725), (460768558853324985155340860819265986152674034869138918/92206108647145381512807243877659142919809988097449, 341547658001112467143416961555068997902887771280362445/62906091145924582757106139314594329871467711904649, 114752793628302822243627020171011071846029981304989826/20430707055386007479776073412242829077095418522083, 780896262817872003326194927851850498335973360132709622/134507573381833016811584325922853183678415834125947, 205499422092756455111831651117452706894708770258607577/34209014407469706990676382313202874863709983486249, 179721612444852721715462697898069714926040853687484453343/50621153647282814450531176888834869462975683465499501, 2381790155288394151301433969955893191615885888925828026808/610171709871759841841668320697066322768114518824258515), (109036568327222767910695367394845422226642587032309/90411024853947207995327440318571422468194380756, 77005756163351505526861071029231386889099016496809/54079796025030251353898068843087652062719303596, 32385156769349680402132934417071223157664882964567/18031333757510228939981227728053875946234785404, 126619882324859162041770255622464250349704252561685/64147830672569254406387292627268913386190554228, 133553604261719592802538491700534878826117388821759/52744093917686888288579775030813707306302584424, 33591719588410449745586401694655601968310481897129969/35531532767601252742163684045198569030000391637108, 1565981357088834837143981639425698973732292625174007071/915796683612792175349325514249449702610511855603164), (2176325407655553188016324325431386036711993507568580938/182143153688453533387011689083752583513488630398527, 89194422228551315301256423854972863783603023494626181/6810235963125894039740595942670941337884825581129, 922191124972639903975769669209520283668963016009761188/65518106028282533766928026833007170790332867674889, 9313170955963891812210927466916943246460299795203296080/615655560282296283566647190291092769157599959978361, 1897446262607990555594964681267194953492969067733963183/110497424773684675277238119049476228228606060142646, 1059561734720009943062488648770010248250284712551660768142/102546595526599339296887580954152704518094098914370701, 31966663094366586269921497131329083226667887191038852530712/2504214081532383131461595793126845776855331541376715935), (7178181700397255213187604865009144827990521411194/826525632190276518733146642124286835991060421, 3999050288020382647753306122811467282218006706341/421208580697490016614393147091810140107456061, 2851486506586798249126439635406193772502364306756/284045652879726434114545195541407310581792291, 28096937946153571404577238556565206490244004052396/2602710095058598296127508727893309903685471211, 5405237710654789893530627065303820507776659415793/446745764989467711088554795757049090940427868, 20759865215537549771843367131426072046297714744092930/2768034342205236061237308104474236613734061349929, 64006302434982661779680475206918034427505233807913524/7144568756403287161901173618561886916095259395401), (7046335236132098085828150573980803131085606570590848353/348893407491099313614454258644944935875474631157211, 7120717774367094557097226675983912723271267605341974511/322707193794219917787347492362142347548279817367379, 152403612427945618826717696103434687701415829740556094123/6774793577174758490019420555448621850221539004650633, 105694640791539813230887912180440743558157662610878483215/4358756417226214843882253371405852052310910549967541, 448558465631912847809000537818768420199578569477868844086/17072344729367741194737906726595091001510385631000379, 42104847022748429399516031726309471290339572905399022525873/2473654259111894133526480693792659595357115134904625990, 6836430124158587076175814261336208434287393888641090270005107/363429668212349064810885204566814683984420691537846903075), (2493815728744762808220195260213008913932450814123738/4447285264441612448933764587399061859035786732717, 1334766394808899821980154053501401036845876127434307/2334740249738299341755912485002465133238537199119, 499510256814650561034055359357727671893581185734798/777641351953627143319203257559524692335576566207, 2904509865979539749912000379700558665552605274375514/4676907480631056405027464747997324825990501240047, 755845765908073213150678773456247796422290366411517/1169285047018471082011686879108787723134695215097, 1806632444672669026452684900108924977812946786899244689/5452371734205416862392795384151249839177874534311042, 8850930478561922549382393533869489700167070233616598364/21809523391153096464831199384868280639254380281489971), (1889360404632825305729080892820590701160507685783453466932/126724413737422331472453505244350081327778347119549085, 458671829713932725493779825172981768509688186121326736077/28095437917313875058462560612093574354755486720080905, 7607207314522212624411734492842543438451566175397924361124/459615890649473101249147223066850465478161894067628049, 18847886440065314392984526974213387635278269098142793077400/1077131666321605050569655046159381582335622116886990291, 5131067620283846658217399237947100603988919132107230699463/281471927798969530369504828231919713745142230633121649, 5248888214914555178556345337415612999516819664083855162005226/464191527520178000183597189710054347903652085498908298355, 114339389213944254683645988272493286510278082871306914984043682/9438114080673442506523626490454431703742065813620513699471), (31933299486307029996046054454337642996412025699496789691/2073254173285116881356603372869295911445969380329730, 17983273277367720512907752480955663606047988487844190997/1067119485944086408653192642789295222837171811154510, 1854525494384914846936758579867727748043952436055191231/103486287736715487989510656177447730537167409321346, 18440822050676203120039345688328439762866478412636924615/957162515737764107616992533435886426383593901811346, 3168993145825669935138985312481026384387380329014629377/146094497745872141507934452635292492748631811575881, 4830756899507004239809524694691343186353665461090196021801/362819480324895454237405590252126784503044641557702750, 536960492759078589637894515987867630381597342891702288245023/33367407281255703029037476067598917458340123646611395490), (1558065863398394783898049978557353060948603391792/635410105009745537588439732406453172771205905, 1175980569596471983231553104005247198781400360513/440668747036029404312041772357642287696080445, 5104364955468041510369147968990269877263009619184/1856489843078269348566010375044754043117260639, 2708908511892229408648587142769285270286602573100/949379785061669859789291148089498999880381603, 9302473532210919641426513415517752808127143520271/3149071232687918946225704495604389466429845917, 3804362687206842590849557781475612999974382744760/2160394357033134827800695090181940787422100077, 48947400546619727747972542451104455494316734730614478/25420065916899125343578397854994882314551970405555), (1211296931868148621632129514676155395940773382827340419/78527556169327488829447828875155306611868795403905, 1164915094071638636420312278976115853806530843879354451/69011354559290171642949987081571323421756701679495, 14684069542406563860741208823469227098289189973434467031/861057368841829520569199275296701152972783202599581, 3235683092075521889656152837584753612029391150788212065/176199907652630519184290611345522247220673656341179, 12885309180369777310558984859496384351965195215894973540/656249024686864409950990652763506613547663278017641, 1127271872422601611407423576806247892662089586866815482379/88579083359001407399617150971175185858188001215604840, 34287716402302556113945154872559915662705179995627293420569/2492027707281699010471588535459235493979967753423115553), (180094217851708176296375815044040676416838053597766604/22962100145335242241065811261429640416341600161381, 159649216945930602320832434170537679341750474033588461/18569619534593260931832476231075945194943574388057, 153907170136654980450705389915963575128610776229936172/17775461950677693643794876123993873300987242454693, 407372391890040371224766727107419366622970351187679552/44005087148069134044549228309157797014062418196031, 115672962127736143146240526448054824165545764476379411/11882093978502995344531240992009618302474421549061, 233639765386698774466230514784239402805693303203728961282/37680806338495132517588996280006039923216565864826221, 79403225641107358783529845791512604193554416222167536234/12013895838463462537193610931240503635079723138677551), (478738909210531362198631620176456943536618327804717832/47405894641473051675080148866000593405606078450223, 22587720907661013677691484897725408293197162716943449/2040582067676638419198984274732326319946203894789, 137820372893699300135524191077717298210097132895901688/12366857991458409943120842742305665387408205339493, 1106166263622413792701678370002420354014031639641053148/92707157216530450977984486867542217144164480846413, 28797615784144156693833777342460037339807507106482223/2290703544198688344589510233514477851222368565293, 262414516706353599517195371654333813955892779443184160720/32662661407974932604130222568674408856462588052203647, 3495022190019437348925229123096292494299285737029749535602/407895726180200175343516161128454874938432688242951593), (5322311140288182978009210473823600989253997648859458113/1410219866265162386714802072731242966882789816913297, 3329606525351219544333695105323946267592052144663157409/833639700605417164705105202571716208790666617317869, 46314248857328956134239157089662531746215637657839429453/10744245372303546191867272808049016760782083902560413, 7286473389927866276326566908589697906053600584460316907/1699160639700703233556436421285956879468377957180387, 24574449536956806718521545140264830050872439476759771316/5534943902843002755828368633253004553941656284854621, 16194780983096414683800914182615695242303337766702018765805/6675980846899278738707873012309704205223126993267547998, 490229216489651531794799790776505177890663631726340625030559/173625469978565501047793899252877661389631653361350835721), (391338889792741035663424545661133816672828951935583721/40744731589848093106075109105765567884885668152950, 829327385154411154438343096143958853370561220199419571/78797319624148937346187079745588449749346187598130, 536284508792446718222213222975204046569746642205892959/50426081762337717003640383516089856814713244220578, 4083396846827693522424359347438231707439233936411918375/361489240894118746494439617677657332041386208406066, 70419982473893793734744572264638912715396531168600266/5966249079248542330334163122782563357606886422319, 1335415799189922618218535253094323918549290813468900337209/180458416211437204366806658229435700162158624249415550, 1121343542061254059636897261609398002551979252116368303645/141921701505445255007728441691575261245203671926197638), (13083529900110108325432120999847326562913629227610903234631/950268051526203073545536457696745329850688609544696545, 10419606851214364991435099340246658140450948599725115826669/692337799962417827280046766268313793752702266029700505, 3421007270003265484597537504576089963364807397315252470349/222943334134743175691470273714125229888430954777553739, 24649628643123240957341758254843759345101898588781176623205/1530073768704846415208608827991751465056303384502023939, 6613640336516730528097896538571530928198634603421148008086/395295317375330545642050906759113019123656458988806657, 4797331934752489738116078699387468082251219294789728789269713/469432417453944318331495010102192192946240173115080093230, 156949219532113992085551726212669553488736643320169809785264133/14237495396338815313111327903860849647487082163306807483825), (5098483847879427207444086306330049300678377070268194726/318991790514225948349309419154223855571132840483539, 1316379450948381198720904724955637101706877922321244425/75424505048747964679834009652795539713271836273379, 8778766901830165010233424286362354988731288329931494352/490472915308969216749215634865761511309662368203817, 80793645929557686728427977158456769543071596312125344860/4188540409718434514276374541471496314701784603627417, 13621008400215032889698814788823725966925384183292236867/647436709506291118839403237247030505459642892619638, 8075906713561703268930570335559902712617784953173386469774/594919689309031393671462066722627490640162747501800235, 24161908387004394666534699382227380400153533369525175521436/1589501709970741105289972616254734577180216770800752395), (37635735514217042040210445419126183793790899669700046498/2337024050040570938510791761098972604908825220489575, 44102990496642801666255650770297788008820578319613750749/2500595978479589766666914802366085818506839361027645, 56750838584678122838000910224389017209345029752161916892/3192750913686990607005011114021533469792107379610149, 475696113306924013590736761175311376333743061956465669000/24889700058230468681674908891115229844777543126508853, 70887780249928251066127297162110381003455030263768528179/3489428473648743981933940720753105838436015786057166, 62340764258952407419107973808406744604006140820159688067234/4751169893732480717992439650314211305779641673255305975, 2136019504900704231790742809350717250781353072025126938201920/151653194834749631458446516557239548017869533785825950387), (18451938445172047633252845281866437208199665112969623629/7082755999002282356437548435514989818527329512775305, 1568842731982074645083976970934817442004294100974115963/575148443839848983650268486110999091978556757364335, 11945490120818326269881247691470767410059926476816643117/4005220881269038249595442108608735266709539958587017, 23912057644229381316717463402004293995345321181130248415/8141702409856344603285701001051795043139473842838939, 6204795879125960261832980766566147260657968248841582980/2037436130643569366857762634035379848738339289446537, 761272069134468222642252128940201509040942531596596444153/467461895934150635524878196743989328022803747843170130, 23432792524881972128167257739320311639973625702907370246963/12155131067139426655355683938128512722105902929301308841), (19330897990497937146411149309196143808436840538124433748/20717577459282202759189490679378283235017842127322709, 10281503733584503007475396337764247603860386633098938925/10825813533514663009083651333904411166130261694009689, 3854502832434082094187474886929937201882003136784514876/3606303452344237018584859060835740544712176645476743, 22382933348218110479858274740600990833653911553112227832/21679788882351311493413037979727498234746745577221967, 5826206100532042424926317889353388886385162900465441547/5420145783026922213469937673737061805972857226370229, 25701715369544315724163264715530264151953379266931122154414/46759572325599931627490680463356785261435269681367354213, 126167204601489804594751059102933622668627951166747634145338/187038496845410467516269659844919702248727029839127808515), (537997160805719461389377771264171426743072868821533932849/34821657091365657875338652875447388811557842010204541, 489240934472253984270601810418273453521951863996397278349/28894077311145732093528553690072938129383051379790377, 157074826626534132508500593940702049394995461813239726395/9214938059509689590347778405007688138373508038492991, 1278222249803189892629628279065334327525983408046190900939/69927173161760504253942343460554063950943125121916391, 370354724877938572087423226328701328886366223272106737816/19179580944842737159927846970592058755613473448861821, 2656541555589975957628975782077050262989603376586015737436853/214431764368629721196335424407005020301573191098839563478, 5941183692824490232121191982824181995738287694446827184542603/449069648274124106176459343518843960577085080066526024417), (264885278358422579649560284779117313417392633228520102962/47939871780135555541308028171903143138601804165140385, 856680731447557559483717043835950338024655863585331412989/145561836240060188840622769425996343462890806189363785, 302061987191623430224736636139728422475016513873111076318/47970543118474932406083523619034321442482658158205303, 1884534547753511809548542828950752838951334107195104481650/298673936229418662708869531578447707237303598166541631, 489212355391392866406385225832357464470242355343706027553/74944626215492775125093944979012534324488292571240709, 171984456929354089541837691059805260232918459225724411484137/47508412934114335541436255918356014850354387927654121535, 913841575192519604139566359746349997298788083671055000920444/219390001465146891409199961682986921884536011255251422787)]
bernoulli_conditional_times_wodet = {(1, 0, 0, 0, 0, 0): (435456*r^12*p^11 + 1057536*r^11*p^11 + 3013632*r^11*p^10 + 6566400*r^10*p^10 + 9328896*r^10*p^9 + 18042624*r^9*p^9 + 17005056*r^9*p^8 + 29104896*r^8*p^8 + 20110848*r^8*p^7 + 30729216*r^7*p^7 + 48264704/3*r^7*p^6 + 67068160/3*r^6*p^6 + 80184320/9*r^6*p^5 + 103519744/9*r^5*p^5 + 93667328/27*r^5*p^4 + 114618880/27*r^4*p^4 + 76251392/81*r^4*p^3 + 91091200/81*r^3*p^3 + 39838208/243*r^3*p^2 + 49500160/243*r^2*p^2 + 3746816/243*r^2*p + 5487616/243*r*p + 51200/81*r + 102400/81)/(432*r^5*p^5 + 1296*r^4*p^4 + 1440*r^3*p^3 + 704*r^2*p^2 + 464/3*r*p + 160/9)}
bernoulli_conditional_mean_time_from1 = (3758096384/81*r^12*p^11 + 9126805504/81*r^11*p^11 + 234075717632/729*r^11*p^10 + 510027366400/729*r^10*p^10 + 2173790322688/2187*r^10*p^9 + 4204236111872/2187*r^9*p^9 + 11887395733504/6561*r^9*p^8 + 20345796952064/6561*r^8*p^8 + 14058501701632/6561*r^8*p^7 + 21481278930944/6561*r^7*p^7 + 101218420523008/59049*r^7*p^6 + 140652125880320/59049*r^6*p^6 + 168158707056640/177147*r^6*p^5 + 217096638169088/177147*r^5*p^5 + 196434624249856/531441*r^5*p^4 + 240373213429760/531441*r^4*p^4 + 159910759235584/1594323*r^4*p^3 + 191032092262400/1594323*r^3*p^3 + 83546777583616/4782969*r^3*p^2 + 103809359544320/4782969*r^2*p^2 + 7857642668032/4782969*r^2*p + 11508364869632/4782969*r*p + 107374182400/1594323*r + 214748364800/1594323)/(536870912/27*r^12*p^12 + 3758096384/27*r^11*p^11 + 34896609280/81*r^10*p^10 + 564251328512/729*r^9*p^9 + 1962800054272/2187*r^8*p^8 + 519691042816/729*r^7*p^7 + 7989712912384/19683*r^6*p^6 + 10171556298752/59049*r^5*p^5 + 1098974756864/19683*r^4*p^4 + 2460479389696/177147*r^3*p^3 + 4122094862336/1594323*r^2*p^2 + 1535450808320/4782969*r*p + 107374182400/4782969)
